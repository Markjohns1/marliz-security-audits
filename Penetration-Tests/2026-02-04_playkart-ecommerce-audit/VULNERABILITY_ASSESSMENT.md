# Vulnerability Assessment Report: playkartstores.com
**Date:** 2026-02-04
**Audit ID:** MI-2026-X01
**Risk Level:** CRITICAL

---

## 1. Executive Summary
This report documents a comprehensive security audit performed by the **Marliz Intel Security** team on `playkartstores.com`. We identified multiple critical security flaws that allow for total system compromise, customer data exfiltration, and business-wide data deletion. This audit was conducted using professional penetration testing frameworks to identify 'invisible' risks that standard development cycles often overlook.

---

## 2. Identified Vulnerabilities

### 2.1. Broken Access Control (Admin Exposure)
*   **Vulnerability:** The administrative directory `/admin` was accessible to the public internet without session-level enforcement.
*   **Attack Method:** Insecure Direct Object Reference (IDOR) via URL navigation.
*   **Impact:** Unauthorized access to private customer data, home addresses, and phone numbers.

### 2.2. Remote Code Execution (RCE) via "Deep Logic" Backdoor
*   **Vulnerability:** The system contains a diagnostic utility (`ajax_session_handler.php`) that utilizes the dangerous `eval()` function.
*   **Attack Method:** We successfully bypassed the host's Web Application Firewall (WAF) using custom stealth payloads that the server interprets as legitimate commands.
*   **Impact:** A remote actor can command the server to delete files, dump the database, or steal source code without ever needing an admin password.

### 2.3. Plain-Text Credential Leakage (The "Master Keys")
*   **Vulnerability:** Database credentials and admin emails are hardcoded directly into `.php` config files.
*   **Attack Method:** Combined with the RCE vulnerability, an attacker can read the raw source code of `config.php`.
*   **Impact:** Allows for **Remote Database Hijacking**. A hacker can connect directly to the server IP (`88.222.223.142`) via professional tools like MySQL Workbench and "Truncate" (delete) all tables in milliseconds.

---

## 3. The "Vibe Coding" Structural Failures

Beyond specific bugs, the system suffers from architectural technical debt:
*   **Spaghetti Code Logic:** 1,400+ lines of mixed HTML/PHP make it impossible to audit for errors.
*   **Zero Isolation:** Lack of a `.env` file means secrets are "taped to the front door."
*   **Fake Security Aesthetic:** The use of "cartoon emojis" and pricing anomalies (e.g., 13 KSH) flags the site as "Scam Behavior" to Google's indexing bots, leading to potential domain blacklisting.

---

## 4. Attack Path Demonstration

### Step 1: Server Reconnaissance
```bash
ping playkartstores.com
# Result: 88.222.223.142
```

### Step 2: RCE Exploitation
Using the discovered backdoor verification key, we sent the following payload:
```
GET /ajax_session_handler.php?verify=[REDACTED]&php_inj=include('config.php');echo $DB_PASS;
```
**Result:** Server returned the plain-text database password.

### Step 3: Database Exposure (MySQL Workbench)
With the credentials in hand, we configured a remote database connection:
*   **Hostname:** `88.222.223.142`
*   **Port:** `3306`
*   **Username:** `u297960261_playstores`
*   **Password:** `[REDACTED]`

**Note:** Connection was blocked by the host's firewall (Remote MySQL disabled). However, the RCE vulnerability allows for an "Inside Man" attackâ€”running a dump script from within the server that bypasses this protection.

---

## 5. Financial & Business Risk

If this system were handling active payments or M-Pesa integrations:
*   **Payment Interception:** Attackers could redirect payments to their own phone numbers by swapping API keys via the RCE backdoor.
*   **Identity Theft:** Every customer's phone number and location would be harvested and sold on the dark web.
*   **Unrecoverable Loss:** Without hardened backups, one simple `DROP TABLE` command by a malicious actor would terminate the entire business venture.

---

## 6. Required Defensive Actions

| Priority | Action |
| :--- | :--- |
| **CRITICAL** | **IMMEDIATELY DELETE** `ajax_session_handler.php` from the server. |
| **CRITICAL** | Relocate credentials to a secured `.env` file outside the web root. |
| **HIGH** | Lockdown `/admin` with a forced session-check middleware. |
| **HIGH** | Perform a "UI Healing" to remove technical artifacts and fix mobile navigation. |
| **MEDIUM** | Refactor `index.php` to separate business logic from presentation layer. |

---

## 7. Conclusion

The current state of `playkartstores.com` is **Highly Vulnerable**. The site looks premium to a user, but it is a "Back-End Lamb" ready for slaughter. Total system hardening is required before the site can be considered fit for commercial use.

---

**Prepared by:** Marliz Intel Security Team  
**Lead Analyst:** Mark J.  
**Status:** UNSECURE - CRITICAL ACTION REQUIRED.

---

*End of Report*
